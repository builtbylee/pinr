{
  "findings": [
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Authentication Token: [Layout] Mapbox token configured",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/_layout.tsx",
      "line": 119,
      "snippet": "          if (MAPBOX_TOKEN) {\n            Mapbox.setAccessToken(MAPBOX_TOKEN);\n            console.log('[Layout] Mapbox token configured');\n          } else {\n            console.warn('[Layout] Mapbox token is MISSING');",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.warn() logging Authentication Token: [Layout] Mapbox token is MISSING",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/_layout.tsx",
      "line": 121,
      "snippet": "            console.log('[Layout] Mapbox token configured');\n          } else {\n            console.warn('[Layout] Mapbox token is MISSING');\n          }\n        } catch (e) {",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Authentication Token: [Layout] Failed to set Mapbox token:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/_layout.tsx",
      "line": 124,
      "snippet": "          }\n        } catch (e) {\n          console.error('[Layout] Failed to set Mapbox token:', e);\n        }\n",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.warn() logging Session Data: [Layout] Auth initialization timeout, proceeding w...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/_layout.tsx",
      "line": 165,
      "snippet": "    const safetyTimeout = setTimeout(() => {\n      if (!isComplete) {\n        console.warn('[Layout] Auth initialization timeout, proceeding with no session');\n        isComplete = true;\n        setIsInitializing(false);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Session Data: [Layout] Setting session to:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/_layout.tsx",
      "line": 197,
      "snippet": "          // User is authenticated - check if anonymous or Unknown profile first\n          console.log('[Layout] âœ… User authenticated');\n          console.log('[Layout] Setting session to:', userId);\n          console.log('[Layout] Current session state before:', session);\n",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Session Data: [Layout] Current session state before:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/_layout.tsx",
      "line": 198,
      "snippet": "          console.log('[Layout] âœ… User authenticated');\n          console.log('[Layout] Setting session to:', userId);\n          console.log('[Layout] Current session state before:', session);\n\n          // Check if user is anonymous - if so, sign them out immediately",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Session Data: [Layout] âœ… User authenticated - session set",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/_layout.tsx",
      "line": 227,
      "snippet": "          setCurrentUserId(userId);\n          setIsInitializing(false);\n          console.log('[Layout] âœ… User authenticated - session set');\n          console.log('[Layout] isInitializing set to false');\n",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.warn() logging Session Data: [Layout] This may indicate an orphaned auth sessio...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/_layout.tsx",
      "line": 277,
      "snippet": "              if (!profile || !profile.username || profile.username === 'Unknown') {\n                console.warn('[Layout] âš ï¸ Profile validation failed - profile is null, missing username, or Unknown');\n                console.warn('[Layout] This may indicate an orphaned auth session or Firestore issue');\n                console.warn('[Layout] Continuing session cautiously (no forced logout)');\n",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.warn() logging Session Data: [Layout] Continuing session cautiously (no forced ...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/_layout.tsx",
      "line": 278,
      "snippet": "                console.warn('[Layout] âš ï¸ Profile validation failed - profile is null, missing username, or Unknown');\n                console.warn('[Layout] This may indicate an orphaned auth session or Firestore issue');\n                console.warn('[Layout] Continuing session cautiously (no forced logout)');\n\n                // DO NOT set profileValidationRef.current = true here!",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Session Data: [Layout] âœ… Session set, navigation allowed",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/_layout.tsx",
      "line": 293,
      "snippet": "                setProfileValidated(true);\n                console.log('[Layout] âœ… Profile validation set to true (success)');\n                console.log('[Layout] âœ… Session set, navigation allowed');\n              }\n              console.log('[Layout] ========== AUTH STATE CHANGE END (AUTHENTICATED) ==========');",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.warn() logging Session Data: [Layout] Keeping session active despite validation...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/_layout.tsx",
      "line": 309,
      "snippet": "            if (!profileValidationRef.current) {\n              console.warn('[Layout] âš ï¸ Profile validation timeout after 20s - validation not confirmed');\n              console.warn('[Layout] Keeping session active despite validation timeout to prevent logout loop');\n              // We do NOT sign out here anymore.\n              // Letting the user proceed (even if profile might be incomplete) is better than forced logout.",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Session Data: [Layout] session:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/_layout.tsx",
      "line": 359,
      "snippet": "  console.log('[Layout] isBanCheckLoading:', isBanCheckLoading);\n  console.log('[Layout] isBanned:', isBanned);\n  console.log('[Layout] session:', session || 'NULL');\n  console.log('[Layout] profileValidated:', profileValidated);\n  console.log('[Layout] profileValidationRef.current:', profileValidationRef.current);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Session Data: [Layout] Initialization complete. Session:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/_layout.tsx",
      "line": 390,
      "snippet": "\n  // Once initialization is done, decide where to go\n  console.log('[Layout] Initialization complete. Session:', session);\n\n",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Session Data: [Layout] âœ… User found, setting session immediately...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/_layout.tsx",
      "line": 432,
      "snippet": "\n          if (currentUser) {\n            console.log('[Layout] âœ… User found, setting session immediately:', currentUser.uid);\n            setSession(currentUser.uid);\n            setCurrentUserId(currentUser.uid);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Session Data: [Layout] âœ… Session set, navigation should occur",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/_layout.tsx",
      "line": 437,
      "snippet": "            setProfileValidated(true);\n            setIsInitializing(false);\n            console.log('[Layout] âœ… Session set, navigation should occur');\n          } else {\n            console.log('[Layout] â³ User not found yet, waiting for onAuthStateChanged...');",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/_layout.tsx",
      "line": 138,
      "snippet": "\n      } catch (error) {\n        console.error('[Layout] Critical initialization error:', error);\n      }\n    };",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/_layout.tsx",
      "line": 244,
      "snippet": "              return profile;\n            } catch (error) {\n              console.error('[Layout] Profile validation error:', error);\n              return null;\n            }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/_layout.tsx",
      "line": 299,
      "snippet": "            .catch((error) => {\n              console.error('[Layout] âŒ Profile validation promise rejected');\n              console.error('[Layout] Validation error:', error);\n              // On error, don't set profileValidationRef - let timeout handle it\n              setProfileValidated(false);",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/_layout.tsx",
      "line": 317,
      "snippet": "      } catch (error) {\n        if (isComplete) return; // Already handled by timeout\n        console.error('[Layout] Failed to setup auth listener:', error);\n        isComplete = true;\n        clearTimeout(safetyTimeout);",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Authentication Token: [App] Saving push token:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 440,
      "snippet": "        notificationService.registerForPushNotificationsAsync().then(token => {\n            if (token && currentUserId) {\n                console.log('[App] Saving push token:', token);\n                savePushToken(currentUserId, token);\n            }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Authentication Token: [App] Token registration failed:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 444,
      "snippet": "            }\n        }).catch(err =>\n            console.error('[App] Token registration failed:', err)\n        );\n",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: [App] Flying to new pin at:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 465,
      "snippet": "            } else if (data.type === 'new_pin' && data.lat && data.lon) {\n                // Deep link to new pin location\n                console.log('[App] Flying to new pin at:', data.lat, data.lon);\n                setTimeout(() => {\n                    if (cameraRef.current) {",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: [App] Deep link to pin:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 568,
      "snippet": "                const pinId = url.split('pin/')[1]?.split('?')[0]; // Handle any query params\n                if (pinId) {\n                    console.log('[App] Deep link to pin:', pinId);\n                    // Find the pin and fly to it\n                    const pin = memories.find(m => m.id === pinId);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Payment/Financial Data: [App] Failed to fetch pin for deep link:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 597,
      "snippet": "                            }\n                        } catch (err) {\n                            console.error('[App] Failed to fetch pin for deep link:', err);\n                        }\n                    }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: [App] New Friend Pin detected:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 708,
      "snippet": "                    // Check if friend's pin and NOT my own\n                    if (friends.includes(pin.creatorId) && pin.creatorId !== currentUserId) {\n                        console.log('[App] New Friend Pin detected:', pin.id);\n\n                        // Increment badge",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: [App] Temp pin replaced by real pin:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 737,
      "snippet": "                    replacedTempIds.add(tempPin.id);\n                    tempIdToRealIdMap.current.set(tempPin.id, matchingRealPin.id);\n                    console.log('[App] Temp pin replaced by real pin:', tempPin.id, '->', matchingRealPin.id);\n                }\n            });",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Sensitive Data: Object.keys(updates).length",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 830,
      "snippet": "\n            if (Object.keys(updates).length > 0) {\n                console.log('[App] Updating persistent user cache for', Object.keys(updates).length, 'users');\n                setMultipleUserCache(updates);\n            }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: firestoreProfile.pinColor",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 852,
      "snippet": "            if (firestoreProfile.avatarUrl) setAvatarUri(firestoreProfile.avatarUrl);\n            if (firestoreProfile.pinColor) {\n                console.log('[DEBUG] Syncing pinColor from Firestore:', firestoreProfile.pinColor, '| typeof:', typeof firestoreProfile.pinColor);\n                setPinColor(firestoreProfile.pinColor);\n            }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Payment/Financial Data: [App] No user ID - cannot create pin",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 941,
      "snippet": "        const currentUserId = useMemoryStore.getState().currentUserId;\n        if (!currentUserId) {\n            console.error('[App] No user ID - cannot create pin');\n            return;\n        }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: [App] Updating existing pin:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 948,
      "snippet": "        if ('id' in memoryData && memoryData.id) {\n            const pinId = memoryData.id;\n            console.log('[App] Updating existing pin:', pinId);\n\n            // Optimistic Update (Local)",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: [App] Spinning to new pin:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 1026,
      "snippet": "        setTimeout(() => {\n            if (cameraRef.current) {\n                console.log('[App] Spinning to new pin:', memoryData.location);\n                cameraRef.current.setCamera({\n                    centerCoordinate: memoryData.location,",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: [App] Pin saved to Firestore:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 1061,
      "snippet": "                // Save to Firestore (real-time sync will update with proper ID)\n                const pinId = await addPin(newMemory);\n                console.log('[App] Pin saved to Firestore:', pinId);\n                console.log('[App] Pin data saved:', JSON.stringify(newMemory, null, 2));\n                ",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: [App] Pin data saved:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 1062,
      "snippet": "                const pinId = await addPin(newMemory);\n                console.log('[App] Pin saved to Firestore:', pinId);\n                console.log('[App] Pin data saved:', JSON.stringify(newMemory, null, 2));\n                \n                // Force a small delay to ensure Firestore has processed the write",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: `[App] Notifying ${friends.length} friends about new pin...`",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 1074,
      "snippet": "                console.log(`[App] Friends list for notification:`, friends);\n                if (friends.length > 0) {\n                    console.log(`[App] Notifying ${friends.length} friends about new pin...`);\n                    // Fire and forget - don't await loop to block UI\n                    friends.forEach(friendUid => {",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: [App] Spinning to pin location:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 1105,
      "snippet": "        // Then spin to the pin location\n        if (memoryToSpinTo && cameraRef.current) {\n            console.log('[App] Spinning to pin location:', memoryToSpinTo.location);\n            cameraRef.current.setCamera({\n                centerCoordinate: memoryToSpinTo.location,",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: [App] Creating single pin:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 1783,
      "snippet": "                        }}\n                        onCreateSinglePin={async (pinDraft) => {\n                            console.log('[App] Creating single pin:', pinDraft.title);\n                            try {\n                                // Use existing handleCreateMemory for single pin",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Payment/Financial Data: [App] Pin creation error:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 1802,
      "snippet": "                                useMemoryStore.getState().showToast('Pin created!', 'success');\n                            } catch (error) {\n                                console.error('[App] Pin creation error:', error);\n                                useMemoryStore.getState().showToast('Failed to create pin', 'error');\n                            }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Payment/Financial Data: Failed to hide pin remotely:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 1987,
      "snippet": "                                        await toggleHiddenPinService(currentUserId, pin.id, true);\n                                    } catch (e) {\n                                        console.error('Failed to hide pin remotely:', e);\n                                        // Revert if failed? For now keep local.\n                                    }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 421,
      "snippet": "        notificationService.login(currentUserId).catch((error) => {\n            // Silently catch any OneSignal errors to prevent crashes\n            console.warn('[App] OneSignal login failed (non-critical):', error);\n        });\n",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 435,
      "snippet": "                console.warn('[App] OneSignal Configuration Issues:', config.issues);\n            }\n        }).catch(err => console.error('[App] Config check failed:', err));\n\n        // Ensure token (once)",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 444,
      "snippet": "            }\n        }).catch(err =>\n            console.error('[App] Token registration failed:', err)\n        );\n",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 597,
      "snippet": "                            }\n                        } catch (err) {\n                            console.error('[App] Failed to fetch pin for deep link:', err);\n                        }\n                    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 930,
      "snippet": "        } catch (error: any) {\n            if (error.code !== 'E_PICKER_CANCELLED') {\n                console.error('[App] Error uploading avatar:', error);\n                Alert.alert('Error', 'Failed to upload avatar');\n            }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 1085,
      "snippet": "                // The Firestore listener will receive the update and replace our temp memory\n            } catch (error) {\n                console.error('[App] Error syncing memory to cloud:', error);\n            }\n        })();",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/index.tsx",
      "line": 1802,
      "snippet": "                                useMemoryStore.getState().showToast('Pin created!', 'success');\n                            } catch (error) {\n                                console.error('[App] Pin creation error:', error);\n                                useMemoryStore.getState().showToast('Failed to create pin', 'error');\n                            }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/add-friend.js",
      "line": 21,
      "snippet": "    };\n    const token = jwt.sign(payload, serviceAccount.private_key, { algorithm: 'RS256' });\n    const response = await fetch('https://oauth2.googleapis.com/token', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/add-friend.js",
      "line": 44,
      "snippet": "    const url = `https://firestore.googleapis.com/v1/projects/days-c4ad4/databases/(default)/documents/users/${hackneymanlee_uid}?updateMask.fieldPaths=friends`;\n\n    const resp = await fetch(url, {\n        method: 'PATCH',\n        headers: {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/check-friend-requests.js",
      "line": 21,
      "snippet": "    };\n    const token = jwt.sign(payload, serviceAccount.private_key, { algorithm: 'RS256' });\n    const response = await fetch('https://oauth2.googleapis.com/token', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/check-friend-requests.js",
      "line": 43,
      "snippet": "\n    // Check requests from user1 to user2\n    const query1 = await fetch(queryUrl, {\n        method: 'POST',\n        headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/check-friend-requests.js",
      "line": 77,
      "snippet": "\n    // Check requests from user2 to user1\n    const query2 = await fetch(queryUrl, {\n        method: 'POST',\n        headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/check-friends.js",
      "line": 21,
      "snippet": "    };\n    const token = jwt.sign(payload, serviceAccount.private_key, { algorithm: 'RS256' });\n    const response = await fetch('https://oauth2.googleapis.com/token', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/check-friends.js",
      "line": 35,
      "snippet": "    const uid = 'FVgteJzI1VTVSSQIfNXk5I85Zpj1';\n    const url = `https://firestore.googleapis.com/v1/projects/days-c4ad4/databases/(default)/documents/users/${uid}`;\n    const resp = await fetch(url, { headers: { 'Authorization': `Bearer ${token}` } });\n    const data = await resp.json();\n",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/check-friendship.js",
      "line": 21,
      "snippet": "    };\n    const token = jwt.sign(payload, serviceAccount.private_key, { algorithm: 'RS256' });\n    const response = await fetch('https://oauth2.googleapis.com/token', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/check-friendship.js",
      "line": 34,
      "snippet": "\n    const queryUrl = `${baseUrl}:runQuery`;\n    const queryResp = await fetch(queryUrl, {\n        method: 'POST',\n        headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/check-test-user.js",
      "line": 18,
      "snippet": "    };\n    const token = jwt.sign(payload, serviceAccount.private_key, { algorithm: 'RS256' });\n    const response = await fetch('https://oauth2.googleapis.com/token', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/check-test-user.js",
      "line": 35,
      "snippet": "    // Since get-uids.js worked by listing, we'll do the same.\n    const url = 'https://firestore.googleapis.com/v1/projects/days-c4ad4/databases/(default)/documents/users?pageSize=300';\n    const resp = await fetch(url, { headers });\n    const data = await resp.json();\n",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Authentication Token: \nğŸ“± Push Token:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/check-test-user.js",
      "line": 67,
      "snippet": "        }\n\n        console.log('\\nğŸ“± Push Token:');\n        if (fields.pushToken) {\n            console.log(`âœ… Present: ${fields.pushToken.stringValue.substring(0, 15)}...`);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Authentication Token: \nğŸ“± Push Token (Expo):",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/check-user-notifications.js",
      "line": 40,
      "snippet": "\n        // Check Push Token (Expo)\n        console.log('\\nğŸ“± Push Token (Expo):');\n        if (data.pushToken) {\n            console.log(`âœ… Present: ${data.pushToken.substring(0, 15)}...`);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/check-user-notifications.js",
      "line": 52,
      "snippet": "\n    } catch (error) {\n        console.error('Error checking user:', error);\n    }\n}",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/create-leaderboard-test.js",
      "line": 19,
      "snippet": "    };\n    const token = jwt.sign(payload, serviceAccount.private_key, { algorithm: 'RS256' });\n    const response = await fetch('https://oauth2.googleapis.com/token', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/create-leaderboard-test.js",
      "line": 55,
      "snippet": "        // A. Create User Profile\n        console.log(`\\nProcessing ${user.name} (${uid})...`);\n        await fetch(`https://firestore.googleapis.com/v1/projects/days-c4ad4/databases/(default)/documents/users/${uid}`, {\n            method: 'PATCH',\n            headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/create-leaderboard-test.js",
      "line": 70,
      "snippet": "\n        // B. Add Score to Leaderboard\n        await fetch(`https://firestore.googleapis.com/v1/projects/days-c4ad4/databases/(default)/documents/game_leaderboard`, {\n            method: 'POST',\n            headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/create-leaderboard-test.js",
      "line": 86,
      "snippet": "\n        // C. Send Friend Request to leetest2\n        await fetch(`https://firestore.googleapis.com/v1/projects/days-c4ad4/databases/(default)/documents/friend_requests`, {\n            method: 'POST',\n            headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/find-user.js",
      "line": 18,
      "snippet": "    };\n    const token = jwt.sign(payload, serviceAccount.private_key, { algorithm: 'RS256' });\n    const response = await fetch('https://oauth2.googleapis.com/token', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/find-user.js",
      "line": 33,
      "snippet": "\n    const url = `https://firestore.googleapis.com/v1/projects/days-c4ad4/databases/(default)/documents:runQuery`;\n    const resp = await fetch(url, {\n        method: 'POST',\n        headers: {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/fix-friendship.js",
      "line": 21,
      "snippet": "    };\n    const token = jwt.sign(payload, serviceAccount.private_key, { algorithm: 'RS256' });\n    const response = await fetch('https://oauth2.googleapis.com/token', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/fix-friendship.js",
      "line": 44,
      "snippet": "    const now = new Date().toISOString();\n\n    const resp = await fetch(docUrl, {\n        method: 'PATCH',\n        headers: {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/fix-test-friends.js",
      "line": 18,
      "snippet": "    };\n    const token = jwt.sign(payload, serviceAccount.private_key, { algorithm: 'RS256' });\n    const response = await fetch('https://oauth2.googleapis.com/token', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/fix-test-friends.js",
      "line": 44,
      "snippet": "    const url = `https://firestore.googleapis.com/v1/projects/days-c4ad4/databases/(default)/documents/users/${targetUser_uid}?updateMask.fieldPaths=friends`;\n\n    const resp = await fetch(url, {\n        method: 'PATCH',\n        headers: {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging API Key/Secret: Usage: node generate-apple-secret.js <key-file-pat...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/generate-apple-secret.js",
      "line": 18,
      "snippet": "\nif (args.length < 4) {\n    console.error('Usage: node generate-apple-secret.js <key-file-path> <key-id> <team-id> <client-id>');\n    console.error('');\n    console.error('Example:');",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging API Key/Secret:   node generate-apple-secret.js AuthKey_8TV72LRP85...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/generate-apple-secret.js",
      "line": 21,
      "snippet": "    console.error('');\n    console.error('Example:');\n    console.error('  node generate-apple-secret.js AuthKey_8TV72LRP85.p8 8TV72LRP85 CMBSFLQ5V6 com.builtbylee.app80days.signin');\n    process.exit(1);\n}",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging API Key/Secret: âœ… OAuth Client Secret Generated Successfully!",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/generate-apple-secret.js",
      "line": 85,
      "snippet": "    console.log('');\n    console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');\n    console.log('âœ… OAuth Client Secret Generated Successfully!');\n    console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');\n    console.log('');",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging API Key/Secret: OAuth Client Secret:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/generate-apple-secret.js",
      "line": 93,
      "snippet": "    console.log(`  ${clientId}`);\n    console.log('');\n    console.log('OAuth Client Secret:');\n    console.log(`  ${clientSecret}`);\n    console.log('');",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging API Key/Secret: `  ${clientSecret}`",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/generate-apple-secret.js",
      "line": 94,
      "snippet": "    console.log('');\n    console.log('OAuth Client Secret:');\n    console.log(`  ${clientSecret}`);\n    console.log('');\n    console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Sensitive Data: 1. Go to Firebase Console â†’ Authentication â†’ Sign-...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/generate-apple-secret.js",
      "line": 99,
      "snippet": "    console.log('');\n    console.log('Next steps:');\n    console.log('1. Go to Firebase Console â†’ Authentication â†’ Sign-in method');\n    console.log('2. Click on \"Apple\"');\n    console.log('3. Enable it');",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging API Key/Secret: 4. Enter the OAuth Client ID and Secret above",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/generate-apple-secret.js",
      "line": 102,
      "snippet": "    console.log('2. Click on \"Apple\"');\n    console.log('3. Enable it');\n    console.log('4. Enter the OAuth Client ID and Secret above');\n    console.log('5. Click \"Save\"');\n    console.log('');",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging API Key/Secret: Error generating client secret:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/generate-apple-secret.js",
      "line": 107,
      "snippet": "    \n} catch (error) {\n    console.error('Error generating client secret:', error.message);\n    process.exit(1);\n}",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/generate-apple-secret.js",
      "line": 107,
      "snippet": "    \n} catch (error) {\n    console.error('Error generating client secret:', error.message);\n    process.exit(1);\n}",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/get-uids.js",
      "line": 21,
      "snippet": "    };\n    const token = jwt.sign(payload, serviceAccount.private_key, { algorithm: 'RS256' });\n    const response = await fetch('https://oauth2.googleapis.com/token', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/get-uids.js",
      "line": 33,
      "snippet": "    const token = await getAccessToken();\n    const url = 'https://firestore.googleapis.com/v1/projects/days-c4ad4/databases/(default)/documents/users';\n    const resp = await fetch(url, { headers: { 'Authorization': `Bearer ${token}` } });\n    const data = await resp.json();\n",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/reset-streak-main.js",
      "line": 21,
      "snippet": "    };\n    const token = jwt.sign(payload, serviceAccount.private_key, { algorithm: 'RS256' });\n    const response = await fetch('https://oauth2.googleapis.com/token', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/reset-streak-main.js",
      "line": 36,
      "snippet": "    // Query for user with username 'hackneymanlee'\n    const queryUrl = `${baseUrl}:runQuery`;\n    const queryResp = await fetch(queryUrl, {\n        method: 'POST',\n        headers: {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/reset-streak-main.js",
      "line": 69,
      "snippet": "    // Reset streak\n    const updateUrl = `${baseUrl}/users/${uid}?updateMask.fieldPaths=streak`;\n    const updateResp = await fetch(updateUrl, {\n        method: 'PATCH',\n        headers: {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/reset-streak.js",
      "line": 21,
      "snippet": "    };\n    const token = jwt.sign(payload, serviceAccount.private_key, { algorithm: 'RS256' });\n    const response = await fetch('https://oauth2.googleapis.com/token', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/reset-streak.js",
      "line": 36,
      "snippet": "    // Query for user with username 'leetest2'\n    const queryUrl = `${baseUrl}:runQuery`;\n    const queryResp = await fetch(queryUrl, {\n        method: 'POST',\n        headers: {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/reset-streak.js",
      "line": 69,
      "snippet": "    // Reset streak\n    const updateUrl = `${baseUrl}/users/${uid}?updateMask.fieldPaths=streak`;\n    const updateResp = await fetch(updateUrl, {\n        method: 'PATCH',\n        headers: {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/simulate-gameplay.js",
      "line": 26,
      "snippet": "    };\n    const token = jwt.sign(payload, serviceAccount.private_key, { algorithm: 'RS256' });\n    const response = await fetch('https://oauth2.googleapis.com/token', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/simulate-gameplay.js",
      "line": 36,
      "snippet": "// REST HELPERS\nasync function firestoreGet(token, path) {\n    const response = await fetch(`${BASE_URL}/${path}`, {\n        headers: { 'Authorization': `Bearer ${token}` }\n    });",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/simulate-gameplay.js",
      "line": 43,
      "snippet": "\nasync function firestoreCreate(token, collection, data) {\n    const response = await fetch(`${BASE_URL}/${collection}`, {\n        method: 'POST',\n        headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/simulate-gameplay.js",
      "line": 54,
      "snippet": "    // Construct query param for updateMask\n    const fieldPaths = Object.keys(data).map(k => `updateMask.fieldPaths=${k}`).join('&');\n    const response = await fetch(`${BASE_URL}/${path}?${fieldPaths}`, {\n        method: 'PATCH',\n        headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/simulate-gameplay.js",
      "line": 105,
      "snippet": "    // 1. Get Users\n    console.log('Step 1: Finding users...');\n    const usersResp = await fetch(`${BASE_URL}/users?pageSize=2`, { headers: { 'Authorization': `Bearer ${token}` } });\n    const usersJson = await usersResp.json();\n    if (!usersJson.documents || usersJson.documents.length < 2) {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "HARDCODED_SECRETS",
      "description": "Potential hardcoded secret in variable \"ONE_SIGNAL_REST_API_KEY\"",
      "severity": "HIGH",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/simulate-pin-notification.js",
      "line": 7,
      "snippet": "// Configuration (Mirrors src/services/NotificationService.ts)\nconst ONE_SIGNAL_APP_ID = '5998e50e-ec2e-49fa-9d3f-9639168487ac';\nconst ONE_SIGNAL_REST_API_KEY = 'os_v2_app_lgmokdxmfze7vhj7sy4rnbehvsajdjhgufbegzfkoyeuqj7txtsyebzctnwo577asbhicpokkrh5plskt3kx2zmrvjanqtsumxn22oi';\n\n// Mock Data",
      "suggestion": "Move secrets to environment variables or secure config management"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/simulate-pin-notification.js",
      "line": 31,
      "snippet": "\n    try {\n        const response = await fetch('https://onesignal.com/api/v1/notifications', {\n            method: 'POST',\n            headers: {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: === Starting Pin Notification Simulation ===",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/simulate-pin-notification.js",
      "line": 63,
      "snippet": "\nasync function runSimulation() {\n    console.log('=== Starting Pin Notification Simulation ===');\n\n    // 1. Simulate Notification Sending",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/simulate-pin-notification.js",
      "line": 57,
      "snippet": "\n    } catch (error) {\n        console.error('âŒ [Simulation] Exception during fetch:', error.message);\n        return false;\n    }",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "API_KEY_EXPOSED",
      "description": "Generic API key pattern detected: API_KEY = 'os_v2_app...[REDACTED]",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/simulate-pin-notification.js",
      "line": 7,
      "snippet": "// Configuration (Mirrors src/services/NotificationService.ts)\nconst ONE_SIGNAL_APP_ID = '5998e50e-ec2e-49fa-9d3f-9639168487ac';\nconst ONE_SIGNAL_REST_API_KEY = 'os_v2_app_lgmokdxmfze7vhj7sy4rnbehvsajdjhgufbegzfkoyeuqj7txtsyebzctnwo577asbhicpokkrh5plskt3kx2zmrvjanqtsumxn22oi';\n\n// Mock Data",
      "suggestion": "Move Generic API Key to environment variables or secure config management. Never commit secrets to version control."
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/test-flag-dash.js",
      "line": 44,
      "snippet": "    };\n    const token = jwt.sign(payload, serviceAccount.private_key, { algorithm: 'RS256' });\n    const response = await fetch('https://oauth2.googleapis.com/token', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/test-flag-dash.js",
      "line": 54,
      "snippet": "// FIRESTORE HELPERS\nasync function firestoreGet(token, path) {\n    const response = await fetch(`${BASE_URL}/${path}`, {\n        headers: { 'Authorization': `Bearer ${token}` }\n    });",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/test-flag-dash.js",
      "line": 61,
      "snippet": "\nasync function firestoreCreate(token, collection, data) {\n    const response = await fetch(`${BASE_URL}/${collection}`, {\n        method: 'POST',\n        headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/test-flag-dash.js",
      "line": 71,
      "snippet": "async function firestorePatch(token, path, data) {\n    const fieldPaths = Object.keys(data).map(k => `updateMask.fieldPaths=${k}`).join('&');\n    const response = await fetch(`${BASE_URL}/${path}?${fieldPaths}`, {\n        method: 'PATCH',\n        headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/test-flag-dash.js",
      "line": 80,
      "snippet": "\nasync function firestoreDelete(token, path) {\n    await fetch(`${BASE_URL}/${path}`, {\n        method: 'DELETE',\n        headers: { 'Authorization': `Bearer ${token}` }",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/test-flag-dash.js",
      "line": 143,
      "snippet": "\n    // Get test users\n    const usersResp = await fetch(`${BASE_URL}/users?pageSize=5`, { headers: { 'Authorization': `Bearer ${token}` } });\n    const usersJson = await usersResp.json();\n    if (!usersJson.documents || usersJson.documents.length < 2) {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/test-flag-dash.js",
      "line": 154,
      "snippet": "\n    // Cleanup - delete existing test challenges\n    const cleanupResp = await fetch(`${BASE_URL}/game_challenges?pageSize=100`, { headers: { 'Authorization': `Bearer ${token}` } });\n    const cleanupJson = await cleanupResp.json();\n    let cleanedCount = 0;",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/test-flag-dash.js",
      "line": 457,
      "snippet": "    // Test 6.1: Check Leaderboard Collection Exists\n    {\n        const resp = await fetch(`${BASE_URL}/leaderboards?pageSize=1`, { headers: { 'Authorization': `Bearer ${token}` } });\n        const json = await resp.json();\n        if (resp.ok) pass('Leaderboard Collection', 'Accessible');",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: PIN DROP - STATE TRANSITION & CHALLENGE TESTS",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/test-pin-drop-states.js",
      "line": 15,
      "snippet": "\nconsole.log('='.repeat(60));\nconsole.log('PIN DROP - STATE TRANSITION & CHALLENGE TESTS');\nconsole.log('='.repeat(60));\nconsole.log();",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: PIN DROP GAME - COMPREHENSIVE TEST SUITE",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/test-pin-drop.js",
      "line": 21,
      "snippet": "\nconsole.log('='.repeat(60));\nconsole.log('PIN DROP GAME - COMPREHENSIVE TEST SUITE');\nconsole.log('='.repeat(60));\nconsole.log();",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: ğŸ‰ ALL TESTS PASSED! Pin Drop game is ready for de...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/test-pin-drop.js",
      "line": 479,
      "snippet": "\nif (totalFailed === 0) {\n    console.log('ğŸ‰ ALL TESTS PASSED! Pin Drop game is ready for deployment.');\n} else {\n    console.log('âš ï¸ Some tests failed. Review and fix issues before deployment.');",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Personal Identifiable Information (PII): ğŸ“§ Check lee@getpinr.com for admin notification em...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/test-report.js",
      "line": 31,
      "snippet": "  console.log('âœ… Test report created:', reportRef.id);\n  console.log('');\n  console.log('ğŸ“§ Check lee@getpinr.com for admin notification email!');\n  console.log('   (Email should arrive within 1-2 minutes)');\n}",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Personal Identifiable Information (PII):    (Email should arrive within 1-2 minutes)",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/test-report.js",
      "line": 32,
      "snippet": "  console.log('');\n  console.log('ğŸ“§ Check lee@getpinr.com for admin notification email!');\n  console.log('   (Email should arrive within 1-2 minutes)');\n}\n",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Sensitive Data: \nIf you see a credential error, run:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/test-report.js",
      "line": 42,
      "snippet": "  .catch((error) => {\n    console.error('âŒ Error:', error.message);\n    console.log('\\nIf you see a credential error, run:');\n    console.log('  gcloud auth application-default login');\n    process.exit(1);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/test-report.js",
      "line": 41,
      "snippet": "  })\n  .catch((error) => {\n    console.error('âŒ Error:', error.message);\n    console.log('\\nIf you see a credential error, run:');\n    console.log('  gcloud auth application-default login');",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/test-wiki-search.js",
      "line": 14,
      "snippet": "console.log(\"URL:\", url);\n\nfetch(url, { headers })\n    .then(res => {\n        if (!res.ok) {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/test-wiki-search.js",
      "line": 51,
      "snippet": "    })\n    .catch(err => {\n        console.error(\"CRASH:\", err);\n        process.exit(1);\n    });",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/test_notification_fix.js",
      "line": 49,
      "snippet": "\n    try {\n        const response = await fetch('https://onesignal.com/api/v1/notifications', {\n            method: 'POST',\n            headers: {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging API Key/Secret: âŒ Error: EXPO_PUBLIC_ONESIGNAL_REST_API_KEY not fo...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/test_notification_fix.js",
      "line": 32,
      "snippet": "\n    if (!ONE_SIGNAL_REST_API_KEY) {\n        console.error('âŒ Error: EXPO_PUBLIC_ONESIGNAL_REST_API_KEY not found in .env');\n        return false;\n    }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: === Starting Pin Notification Simulation ===",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/test_notification_fix.js",
      "line": 87,
      "snippet": "\nasync function runSimulation() {\n    console.log('=== Starting Pin Notification Simulation ===');\n    const success = await notifyNewPin(MOCK_FRIEND_UID, MOCK_CREATOR_NAME);\n    if (success) {",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/test_notification_fix.js",
      "line": 81,
      "snippet": "\n    } catch (error) {\n        console.error('âŒ [Simulation] Exception during fetch:', error.message);\n        return false;\n    }",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-explore-backend.js",
      "line": 41,
      "snippet": "    };\n    const token = jwt.sign(payload, serviceAccount.private_key, { algorithm: 'RS256' });\n    const response = await fetch('https://oauth2.googleapis.com/token', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout - vulnerable to slowloris DoS",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-explore-backend.js",
      "line": 59,
      "snippet": "        const query = 'London';\n        const url = `https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(query)}.json?access_token=${MAPBOX_TOKEN}&types=place&limit=1`;\n        const resp = await fetch(url);\n        if (resp.ok) {\n            const data = await resp.json();",
      "suggestion": "Add timeout to fetch using AbortSignal with setTimeout, or use a library like axios with timeout config."
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-explore-backend.js",
      "line": 79,
      "snippet": "\n    // Create User Doc\n    await fetch(`${BASE_URL}/${USERS_COLLECTION}?documentId=${TEST_UID}`, {\n        method: 'POST',\n        headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-explore-backend.js",
      "line": 103,
      "snippet": "\n    console.log('Adding \"Eiffel Tower\" to Bucket List...');\n    const addResp = await fetch(`${BASE_URL}/${USERS_COLLECTION}/${TEST_UID}:runQuery`, { // Using runQuery? No, define patch.\n        // Actually arrayUnion via REST is tricky. We'll read, modify, write (simulate client logic).\n        // Or simpler: Just WRITE the array directly.",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-explore-backend.js",
      "line": 110,
      "snippet": "\n    // Simplification for REST Script: READ -> PUSH -> WRITE\n    const readResp = await fetch(`${BASE_URL}/${USERS_COLLECTION}/${TEST_UID}`, {\n        headers: { 'Authorization': `Bearer ${token}` }\n    });",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-explore-backend.js",
      "line": 117,
      "snippet": "    currentBucket.push(firestoreItem);\n\n    const updateResp = await fetch(`${BASE_URL}/${USERS_COLLECTION}/${TEST_UID}?updateMask.fieldPaths=bucketList`, {\n        method: 'PATCH',\n        headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-explore-backend.js",
      "line": 135,
      "snippet": "\n    // Verify\n    const verifyResp = await fetch(`${BASE_URL}/${USERS_COLLECTION}/${TEST_UID}`, {\n        headers: { 'Authorization': `Bearer ${token}` }\n    });",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-explore-backend.js",
      "line": 150,
      "snippet": "    // Cleanup\n    console.log('\\n--- Cleanup ---');\n    await fetch(`${BASE_URL}/${USERS_COLLECTION}/${TEST_UID}`, {\n        method: 'DELETE',\n        headers: { 'Authorization': `Bearer ${token}` }",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Authentication Token: âŒ Missing EXPO_PUBLIC_MAPBOX_TOKEN in .env",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-explore-backend.js",
      "line": 55,
      "snippet": "    console.log('--- Step 1: Mapbox Geocoding ---');\n    if (!MAPBOX_TOKEN) {\n        console.error('âŒ Missing EXPO_PUBLIC_MAPBOX_TOKEN in .env');\n    } else {\n        const query = 'London';",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-explore-backend.js",
      "line": 131,
      "snippet": "    } else {\n        const err = await updateResp.json();\n        console.error('âŒ Update Failed:', err);\n    }\n",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "OAUTH_TOKEN_IN_URL",
      "description": "Authentication token passed as URL query parameter in template",
      "severity": "HIGH",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-explore-backend.js",
      "line": 58,
      "snippet": "    } else {\n        const query = 'London';\n        const url = `https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(query)}.json?access_token=${MAPBOX_TOKEN}&types=place&limit=1`;\n        const resp = await fetch(url);\n        if (resp.ok) {",
      "suggestion": "Use Authorization header instead of URL parameters for tokens"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-friend-flow.js",
      "line": 25,
      "snippet": "    };\n    const token = jwt.sign(payload, serviceAccount.private_key, { algorithm: 'RS256' });\n    const response = await fetch('https://oauth2.googleapis.com/token', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-friend-flow.js",
      "line": 64,
      "snippet": "    };\n\n    const createResp = await fetch(`${BASE_URL}/${COLLECTION}`, {\n        method: 'POST',\n        headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-friend-flow.js",
      "line": 78,
      "snippet": "    // 2. Verify Pending State\n    console.log('\\n--- Step 2: Verifying Pending State ---');\n    const getResp = await fetch(`${BASE_URL}/${COLLECTION}/${requestId}`, {\n        headers: { 'Authorization': `Bearer ${token}` }\n    });",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-friend-flow.js",
      "line": 91,
      "snippet": "    // 3. Accept Request (Update Status)\n    console.log('\\n--- Step 3: Accepting Request ---');\n    const updateResp = await fetch(`${BASE_URL}/${COLLECTION}/${requestId}?updateMask.fieldPaths=status`, {\n        method: 'PATCH',\n        headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-friend-flow.js",
      "line": 109,
      "snippet": "    console.log('\\n--- Step 4: Verifying Friendship ---');\n    // Query: fromUid == USER_A && status == accepted\n    const queryResp = await fetch(`${BASE_URL}:runQuery`, {\n        method: 'POST',\n        headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-friend-flow.js",
      "line": 139,
      "snippet": "    // 5. Cleanup\n    console.log('\\n--- Cleanup ---');\n    await fetch(`${BASE_URL}/${COLLECTION}/${requestId}`, {\n        method: 'DELETE',\n        headers: { 'Authorization': `Bearer ${token}` }",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-notifications.js",
      "line": 32,
      "snippet": "    const token = jwt.sign(payload, serviceAccount.private_key, { algorithm: 'RS256' });\n\n    const response = await fetch('https://oauth2.googleapis.com/token', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-notifications.js",
      "line": 44,
      "snippet": "async function getFirestoreDocument(accessToken, collection, docId) {\n    const url = `https://firestore.googleapis.com/v1/projects/${PROJECT_ID}/databases/(default)/documents/${collection}/${docId}`;\n    const response = await fetch(url, {\n        headers: { 'Authorization': `Bearer ${accessToken}` }\n    });",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-notifications.js",
      "line": 52,
      "snippet": "async function listCollection(accessToken, collection) {\n    const url = `https://firestore.googleapis.com/v1/projects/${PROJECT_ID}/databases/(default)/documents/${collection}`;\n    const response = await fetch(url, {\n        headers: { 'Authorization': `Bearer ${accessToken}` }\n    });",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-notifications.js",
      "line": 143,
      "snippet": "        console.log(`  Sending test notification to: ${testUser.username}`);\n\n        const response = await fetch('https://exp.host/--/api/v2/push/send', {\n            method: 'POST',\n            headers: {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Authentication Token:   âœ“ Access token obtained",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-notifications.js",
      "line": 78,
      "snippet": "    console.log('Step 1: Authenticating with Firebase...');\n    const accessToken = await getAccessToken();\n    console.log('  âœ“ Access token obtained');\n\n    // Step 2: Get all users",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Authentication Token: `    Token: ${user.pushToken ? user.pushToken.substring(0, 4...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-notifications.js",
      "line": 133,
      "snippet": "        }\n        console.log(`  User: ${user.username}`);\n        console.log(`    Token: ${user.pushToken ? user.pushToken.substring(0, 40) + '...' : 'MISSING'}`);\n        console.log(`    Friends: ${friendNames.length > 0 ? friendNames.join(', ') : 'NONE'}`);\n    }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-onesignal-key.js",
      "line": 93,
      "snippet": "    \n    try {\n        const response = await fetch('https://onesignal.com/api/v1/players?app_id=' + appId, {\n            method: 'GET',\n            headers: {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "HARDCODED_SECRETS",
      "description": "Potential hardcoded secret in variable \"ONE_SIGNAL_REST_API_KEY\"",
      "severity": "HIGH",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-pin-notification.js",
      "line": 6,
      "snippet": "// Configuration\nconst ONE_SIGNAL_APP_ID = '5998e50e-ec2e-49fa-9d3f-9639168487ac';\nconst ONE_SIGNAL_REST_API_KEY = 'os_v2_app_lgmokdxmfze7vhj7sy4rnbehvsajdjhgufbegzfkoyeuqj7txtsyebzctnwo577asbhicpokkrh5plskt3kx2zmrvjanqtsumxn22oi';\n\n// Test Data",
      "suggestion": "Move secrets to environment variables or secure config management"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-pin-notification.js",
      "line": 37,
      "snippet": "\n    try {\n        const response = await fetch('https://onesignal.com/api/v1/notifications', {\n            method: 'POST',\n            headers: {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-pin-notification.js",
      "line": 57,
      "snippet": "\n    } catch (error) {\n        console.error('TEST FAILED: Exception during fetch:', error);\n    }\n}",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "API_KEY_EXPOSED",
      "description": "Generic API key pattern detected: API_KEY = 'os_v2_app...[REDACTED]",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-pin-notification.js",
      "line": 6,
      "snippet": "// Configuration\nconst ONE_SIGNAL_APP_ID = '5998e50e-ec2e-49fa-9d3f-9639168487ac';\nconst ONE_SIGNAL_REST_API_KEY = 'os_v2_app_lgmokdxmfze7vhj7sy4rnbehvsajdjhgufbegzfkoyeuqj7txtsyebzctnwo577asbhicpokkrh5plskt3kx2zmrvjanqtsumxn22oi';\n\n// Test Data",
      "suggestion": "Move Generic API Key to environment variables or secure config management. Never commit secrets to version control."
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-stories.js",
      "line": 26,
      "snippet": "    };\n    const token = jwt.sign(payload, serviceAccount.private_key, { algorithm: 'RS256' });\n    const response = await fetch('https://oauth2.googleapis.com/token', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-stories.js",
      "line": 106,
      "snippet": "    }\n\n    const createResp = await fetch(`${BASE_URL}/${STORIES_COLLECTION}`, {\n        method: 'POST',\n        headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-stories.js",
      "line": 120,
      "snippet": "    // 3. Scenario: Read & Verify\n    console.log('\\n--- SCENARIO 2: READ & VERIFY ---');\n    const readResp = await fetch(`${BASE_URL}/${STORIES_COLLECTION}/${story1Id}`, {\n        headers: { 'Authorization': `Bearer ${token}` }\n    });",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-stories.js",
      "line": 137,
      "snippet": "    console.log('Creating 4 shadow stories...');\n    for (let i = 0; i < 4; i++) {\n        await fetch(`${BASE_URL}/${STORIES_COLLECTION}`, {\n            method: 'POST',\n            headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-stories.js",
      "line": 145,
      "snippet": "\n    // Now query count\n    const queryResp = await fetch(`${BASE_URL}:runQuery`, {\n        method: 'POST',\n        headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-stories.js",
      "line": 180,
      "snippet": "    for (const d of validDocs) {\n        const id = d.document.name.split('/').pop();\n        await fetch(`${BASE_URL}/${STORIES_COLLECTION}/${id}`, {\n            method: 'DELETE',\n            headers: { 'Authorization': `Bearer ${token}` }",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: âœ… Data Integrity Verified (Title matching, Pin cou...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-stories.js",
      "line": 127,
      "snippet": "\n    if (readData.title === story1Data.title && readData.pinIds.length === 2) {\n        console.log('âœ… Data Integrity Verified (Title matching, Pin count correct)');\n    } else {\n        console.error('âŒ Data Integrity Mismatch:', readData);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Sensitive Data: `Found ${Object.keys(imageMap).length} entries in triviaImag...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-trivia-images.js",
      "line": 54,
      "snippet": "\nconsole.log('--- STARTING VERIFICATION ---');\nconsole.log(`Found ${Object.keys(imageMap).length} entries in triviaImages.ts`);\nconsole.log(`Found ${questionsWithImages.length} questions with imageKey in triviaQuestions.ts`);\n",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-unsplash.js",
      "line": 35,
      "snippet": "\n    try {\n        const response = await fetch(\n            `${UNSPLASH_BASE_URL}/search/photos?query=${encodeURIComponent(query)}&per_page=1&orientation=landscape`,\n            {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/scripts/verify-unsplash.js",
      "line": 80,
      "snippet": "        const url = `${WIKI_SEARCH_API}?action=query&generator=prefixsearch&gpssearch=${encodeURIComponent(query)}&gpslimit=1&prop=coordinates|pageimages|description&piprop=thumbnail&pithumbsize=200&format=json`;\n\n        const response = await fetch(url, { headers: WIKI_HEADERS });\n\n        if (!response.ok) {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/sandbox/games.tsx",
      "line": 244,
      "snippet": "                    }\n                } catch (error: any) {\n                    console.error('[GameSandbox] Error in challenge subscription:', error);\n                    setErrorInfo('Failed to load games: ' + (error.message || 'Unknown error'));\n                }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/sandbox/games.tsx",
      "line": 248,
      "snippet": "                }\n            }, (error) => {\n                console.error('[GameSandbox] Firestore Subscription Error:', error);\n                setErrorInfo(`Firestore Error: ${error.code || error.message}`);\n                // Could be 'permission-denied', 'unavailable', etc.",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/sandbox/games.tsx",
      "line": 389,
      "snippet": "            }\n        } catch (error) {\n            console.error('Failed to fetch leaderboard:', error);\n        } finally {\n            setLoadingLeaderboard(false);",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/sandbox/games.tsx",
      "line": 419,
      "snippet": "            setFriends(friendProfiles);\n        } catch (error) {\n            console.error('[GameSandbox] Failed to load friends:', error);\n        } finally {\n            setLoadingFriends(false);",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/app/sandbox/games.tsx",
      "line": 440,
      "snippet": "            }\n        } catch (error) {\n            console.error('[GameSandbox] Failed to send challenge:', error);\n        }\n    };",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 634,
      "snippet": "    try {\n        // Send email via Resend API\n        const response = await fetch('https://api.resend.com/emails', {\n            method: 'POST',\n            headers: {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 912,
      "snippet": "</html>\n            `;\n        const response = await fetch('https://api.resend.com/emails', {\n            method: 'POST',\n            headers: {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Personal Identifiable Information (PII): `[onWaitlistSignup] Email already sent to ${email}, skipping...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 571,
      "snippet": "    // Skip if email already sent (shouldn't happen on create, but safety check)\n    if (data.emailSent) {\n        console.log(`[onWaitlistSignup] Email already sent to ${email}, skipping`);\n        return;\n    }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Personal Identifiable Information (PII): `[onWaitlistSignup] New signup: ${email} (${platform})`",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 575,
      "snippet": "    }\n    const platform = data.platform || 'unknown';\n    console.log(`[onWaitlistSignup] New signup: ${email} (${platform})`);\n    // Platform detection for personalized messaging\n    const LANDING_PAGE = 'https://getpinr.com';",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging API Key/Secret: [onWaitlistSignup] No Resend API key configured. S...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 629,
      "snippet": "    const resendApiKey = getResendApiKey();\n    if (!resendApiKey) {\n        console.error('[onWaitlistSignup] No Resend API key configured. Set it with: firebase functions:config:set resend.api_key=\"YOUR_KEY\"');\n        return;\n    }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Personal Identifiable Information (PII): `[onWaitlistSignup] Email sent to ${email}, ID: ${result.id}...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 653,
      "snippet": "        }\n        const result = await response.json();\n        console.log(`[onWaitlistSignup] Email sent to ${email}, ID: ${result.id}`);\n        // Mark email as sent\n        await snapshot.ref.update({ emailSent: true });",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Personal Identifiable Information (PII): [onWaitlistSignup] Failed to send email:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 658,
      "snippet": "    }\n    catch (error) {\n        console.error('[onWaitlistSignup] Failed to send email:', error.message);\n    }\n});",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: `[adminDeletePin] Pin ${pinId} deleted by ${context.auth.uid...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 766,
      "snippet": "    try {\n        await db.collection('pins').doc(pinId).delete();\n        console.log(`[adminDeletePin] Pin ${pinId} deleted by ${context.auth.uid}`);\n        return { success: true };\n    }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: `[onReportCreated] Pin ${reportData.reportedPinId} marked as...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 865,
      "snippet": "                `;\n            targetLink = `https://console.firebase.google.com/project/days-c4ad4/firestore/data/~2Fpins~2F${reportData.reportedPinId}`;\n            console.log(`[onReportCreated] Pin ${reportData.reportedPinId} marked as under review`);\n        }\n        else if (reportData.reportedUserId) {",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging API Key/Secret: [onReportCreated] RESEND_API_KEY not configured",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 881,
      "snippet": "        const resendApiKey = (_a = functions.config().resend) === null || _a === void 0 ? void 0 : _a.api_key;\n        if (!resendApiKey) {\n            console.error('[onReportCreated] RESEND_API_KEY not configured');\n            return;\n        }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Personal Identifiable Information (PII): `[onReportCreated] Email error: ${response.status} - ${error...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 927,
      "snippet": "        if (!response.ok) {\n            const errorBody = await response.text();\n            console.error(`[onReportCreated] Email error: ${response.status} - ${errorBody}`);\n            return;\n        }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: `[approveReportedPin] Pin ${pinId} approved by ${context.aut...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 964,
      "snippet": "            });\n        }\n        console.log(`[approveReportedPin] Pin ${pinId} approved by ${context.auth.uid}`);\n        return { success: true };\n    }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: `[rejectReportedPin] Pin ${pinId} deleted by ${context.auth....",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 995,
      "snippet": "            });\n        }\n        console.log(`[rejectReportedPin] Pin ${pinId} deleted by ${context.auth.uid}`);\n        return { success: true };\n    }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 88,
      "snippet": "    }\n    catch (error) {\n        console.error('[RateLimit] Error checking rate limit:', error);\n        // Fail open to avoid blocking legitimate users\n        return { allowed: true, remaining: config.maxRequests };",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 162,
      "snippet": "            throw error;\n        }\n        console.error('[addFriend] Error:', error);\n        throw new functions.https.HttpsError('internal', error.message || 'Failed to add friend.');\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 203,
      "snippet": "    }\n    catch (error) {\n        console.error('[removeFriend] Error:', error);\n        throw new functions.https.HttpsError('internal', error.message || 'Failed to remove friend.');\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 278,
      "snippet": "            throw error;\n        }\n        console.error('[acceptFriendRequest] Error:', error);\n        throw new functions.https.HttpsError('internal', error.message || 'Failed to accept friend request.');\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 658,
      "snippet": "    }\n    catch (error) {\n        console.error('[onWaitlistSignup] Failed to send email:', error.message);\n    }\n});",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 703,
      "snippet": "    }\n    catch (error) {\n        console.error('[banUser] Error:', error.message);\n        throw new functions.https.HttpsError('internal', 'Failed to ban user.');\n    }",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 728,
      "snippet": "    }\n    catch (error) {\n        console.error('[unbanUser] Error:', error.message);\n        throw new functions.https.HttpsError('internal', 'Failed to unban user.');\n    }",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 749,
      "snippet": "    }\n    catch (error) {\n        console.error('[checkBanStatus] Error:', error.message);\n        return { banned: false };\n    }",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 770,
      "snippet": "    }\n    catch (error) {\n        console.error('[adminDeletePin] Error:', error.message);\n        throw new functions.https.HttpsError('internal', 'Failed to delete pin.');\n    }",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 822,
      "snippet": "    }\n    catch (error) {\n        console.error('[moderateImage] Error:', error.message);\n        // On error, allow the image (fail open) but log for review\n        // In production, you may want to fail closed instead",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 933,
      "snippet": "    }\n    catch (error) {\n        console.error('[onReportCreated] Error:', error.message);\n    }\n});",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 968,
      "snippet": "    }\n    catch (error) {\n        console.error('[approveReportedPin] Error:', error.message);\n        throw new functions.https.HttpsError('internal', 'Failed to approve pin.');\n    }",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 999,
      "snippet": "    }\n    catch (error) {\n        console.error('[rejectReportedPin] Error:', error.message);\n        throw new functions.https.HttpsError('internal', 'Failed to reject pin.');\n    }",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 1057,
      "snippet": "    }\n    catch (error) {\n        console.error('[fetchActiveGames] Error:', error);\n        throw new functions.https.HttpsError('internal', error.message || 'Failed to fetch games.');\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "MISSING_RUNTIME_INTEGRITY_CHECKS",
      "description": "Sensitive app without runtime integrity or tamper detection",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/lib/index.js",
      "line": 1,
      "suggestion": "Implement runtime integrity checks: Play Integrity API (Android), App Attest (iOS), or signature verification to detect tampering."
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 849,
      "snippet": "        try {\n            // Send email via Resend API\n            const response = await fetch('https://api.resend.com/emails', {\n                method: 'POST',\n                headers: {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 1200,
      "snippet": "            `;\n\n            const response = await fetch('https://api.resend.com/emails', {\n                method: 'POST',\n                headers: {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Personal Identifiable Information (PII): `[onWaitlistSignup] Email already sent to ${email}, skipping...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 780,
      "snippet": "        // Skip if email already sent (shouldn't happen on create, but safety check)\n        if (data.emailSent) {\n            console.log(`[onWaitlistSignup] Email already sent to ${email}, skipping`);\n            return;\n        }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Personal Identifiable Information (PII): `[onWaitlistSignup] New signup: ${email} (${platform})`",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 785,
      "snippet": "\n        const platform = data.platform || 'unknown';\n        console.log(`[onWaitlistSignup] New signup: ${email} (${platform})`);\n\n        // Platform detection for personalized messaging",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging API Key/Secret: [onWaitlistSignup] No Resend API key configured. S...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 843,
      "snippet": "\n        if (!resendApiKey) {\n            console.error('[onWaitlistSignup] No Resend API key configured. Set it with: firebase functions:config:set resend.api_key=\"YOUR_KEY\"');\n            return;\n        }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Personal Identifiable Information (PII): `[onWaitlistSignup] Email sent to ${email}, ID: ${result.id}...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 870,
      "snippet": "\n            const result = await response.json();\n            console.log(`[onWaitlistSignup] Email sent to ${email}, ID: ${result.id}`);\n\n            // Mark email as sent",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Personal Identifiable Information (PII): [onWaitlistSignup] Failed to send email:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 876,
      "snippet": "\n        } catch (error: any) {\n            console.error('[onWaitlistSignup] Failed to send email:', error.message);\n        }\n    });",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: `[adminDeletePin] Pin ${pinId} deleted by ${context.auth.uid...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 1027,
      "snippet": "    try {\n        await db.collection('pins').doc(pinId).delete();\n        console.log(`[adminDeletePin] Pin ${pinId} deleted by ${context.auth.uid}`);\n        return { success: true };\n",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: `[onReportCreated] Pin ${reportData.reportedPinId} marked as...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 1150,
      "snippet": "                targetLink = `https://console.firebase.google.com/project/days-c4ad4/firestore/data/~2Fpins~2F${reportData.reportedPinId}`;\n\n                console.log(`[onReportCreated] Pin ${reportData.reportedPinId} marked as under review`);\n            } else if (reportData.reportedUserId) {\n                // User report",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging API Key/Secret: [onReportCreated] RESEND_API_KEY not configured",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 1167,
      "snippet": "            const resendApiKey = functions.config().resend?.api_key;\n            if (!resendApiKey) {\n                console.error('[onReportCreated] RESEND_API_KEY not configured');\n                return;\n            }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Personal Identifiable Information (PII): `[onReportCreated] Email error: ${response.status} - ${error...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 1216,
      "snippet": "            if (!response.ok) {\n                const errorBody = await response.text();\n                console.error(`[onReportCreated] Email error: ${response.status} - ${errorBody}`);\n                return;\n            }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: `[approveReportedPin] Pin ${pinId} approved by ${context.aut...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 1263,
      "snippet": "        }\n\n        console.log(`[approveReportedPin] Pin ${pinId} approved by ${context.auth.uid}`);\n        return { success: true };\n",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: `[rejectReportedPin] Pin ${pinId} deleted by ${context.auth....",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 1303,
      "snippet": "        }\n\n        console.log(`[rejectReportedPin] Pin ${pinId} deleted by ${context.auth.uid}`);\n        return { success: true };\n",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 68,
      "snippet": "        return { allowed: true, remaining: config.maxRequests - data.count - 1 };\n    } catch (error) {\n        console.error('[RateLimit] Error checking rate limit:', error);\n        // Fail open to avoid blocking legitimate users\n        return { allowed: true, remaining: config.maxRequests };",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 178,
      "snippet": "            throw error;\n        }\n        console.error('[addFriend] Error:', error);\n        throw new functions.https.HttpsError(\n            'internal',",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 239,
      "snippet": "        };\n    } catch (error: any) {\n        console.error('[removeFriend] Error:', error);\n        throw new functions.https.HttpsError(\n            'internal',",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 356,
      "snippet": "            throw error;\n        }\n        console.error('[acceptFriendRequest] Error:', error);\n        throw new functions.https.HttpsError(\n            'internal',",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 876,
      "snippet": "\n        } catch (error: any) {\n            console.error('[onWaitlistSignup] Failed to send email:', error.message);\n        }\n    });",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 937,
      "snippet": "\n    } catch (error: any) {\n        console.error('[banUser] Error:', error.message);\n        throw new functions.https.HttpsError('internal', 'Failed to ban user.');\n    }",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 973,
      "snippet": "\n    } catch (error: any) {\n        console.error('[unbanUser] Error:', error.message);\n        throw new functions.https.HttpsError('internal', 'Failed to unban user.');\n    }",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 1000,
      "snippet": "\n    } catch (error: any) {\n        console.error('[checkBanStatus] Error:', error.message);\n        return { banned: false };\n    }",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 1031,
      "snippet": "\n    } catch (error: any) {\n        console.error('[adminDeletePin] Error:', error.message);\n        throw new functions.https.HttpsError('internal', 'Failed to delete pin.');\n    }",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 1100,
      "snippet": "\n    } catch (error: any) {\n        console.error('[moderateImage] Error:', error.message);\n        // On error, allow the image (fail open) but log for review\n        // In production, you may want to fail closed instead",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 1223,
      "snippet": "\n        } catch (error: any) {\n            console.error('[onReportCreated] Error:', error.message);\n        }\n    });",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 1267,
      "snippet": "\n    } catch (error: any) {\n        console.error('[approveReportedPin] Error:', error.message);\n        throw new functions.https.HttpsError('internal', 'Failed to approve pin.');\n    }",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 1307,
      "snippet": "\n    } catch (error: any) {\n        console.error('[rejectReportedPin] Error:', error.message);\n        throw new functions.https.HttpsError('internal', 'Failed to reject pin.');\n    }",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 1383,
      "snippet": "\n    } catch (error: any) {\n        console.error('[fetchActiveGames] Error:', error);\n        throw new functions.https.HttpsError(\n            'internal',",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "MISSING_RUNTIME_INTEGRITY_CHECKS",
      "description": "Sensitive app without runtime integrity or tamper detection",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/functions/src/index.ts",
      "line": 1,
      "suggestion": "Implement runtime integrity checks: Play Integrity API (Android), App Attest (iOS), or signature verification to detect tampering."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/ChallengeFriendModal.tsx",
      "line": 91,
      "snippet": "            Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);\n        } catch (error) {\n            console.error('Failed to send challenge:', error);\n            Haptics.notificationAsync(Haptics.NotificationFeedbackType.Error);\n        } finally {",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/CreationModal.tsx",
      "line": 129,
      "snippet": "        } catch (error: any) {\n            if (error.code !== 'E_PICKER_CANCELLED') {\n                console.error('[CreationModal] Error picking image:', error);\n            }\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/CreationModal.tsx",
      "line": 161,
      "snippet": "            setSuggestions(results);\n        } catch (error) {\n            console.error('[Autocomplete] Error fetching suggestions:', error);\n        } finally {\n            setIsSearching(false);",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/CreationModal.tsx",
      "line": 500,
      "snippet": "                                                } catch (error: any) {\n                                                    if (error.code !== 'E_PICKER_CANCELLED') {\n                                                        console.error('[CreationModal] Error opening native editor:', error);\n                                                        Alert.alert('Error', 'Failed to open photo editor');\n                                                    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "TEXT_INPUT_NO_SECURE",
      "description": "TextInput for pin without secureTextEntry property",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/CreationModal.tsx",
      "line": 389,
      "snippet": "                        <View style={styles.inputGroup}>\n                            <Text style={styles.label}>Title</Text>\n                            <TextInput\n                                style={styles.input}\n                                placeholder=\"Give your pin a name...\"",
      "suggestion": "Add secureTextEntry={true} to hide sensitive input and prevent screen recording/screenshots of this field"
    },
    {
      "ruleId": "TEXT_INPUT_NO_SECURE",
      "description": "TextInput for pin without secureTextEntry property",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/CreationModal.tsx",
      "line": 402,
      "snippet": "                            <View style={styles.searchContainer}>\n                                <View style={styles.searchRow}>\n                                    <TextInput\n                                        style={[styles.input, { flex: 1, marginRight: 10 }]}\n                                        placeholder=\"Start typing...\"",
      "suggestion": "Add secureTextEntry={true} to hide sensitive input and prevent screen recording/screenshots of this field"
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/DestinationCard.tsx",
      "line": 84,
      "snippet": "                            onClose();\n                        } catch (error) {\n                            console.error('[DestinationCard] Delete failed:', error);\n                            Alert.alert('Error', 'Failed to delete pin. Please try again.');\n                        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/ErrorBoundary.tsx",
      "line": 24,
      "snippet": "\n    componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n        console.error('[ErrorBoundary] Caught error:', error, errorInfo);\n    }\n",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/ExploreInfoCard.tsx",
      "line": 90,
      "snippet": "            setIsInBucketList(true);\n        } catch (error) {\n            console.error(\"Failed to add bucket list item:\", error);\n            Alert.alert(\"Error\", \"Could not add to bucket list.\");\n        } finally {",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/FriendsModal.tsx",
      "line": 130,
      "snippet": "            }\n        } catch (error) {\n            console.error('Error loading friends list:', error);\n            // Don't throw, continue to requests\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/FriendsModal.tsx",
      "line": 139,
      "snippet": "            setFriendRequests(requestsData);\n        } catch (error) {\n            console.error('Error loading friend requests:', error);\n        }\n    };",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Catch block shows raw error message to user - may expose sensitive backend details",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/FriendsModal.tsx",
      "line": 192,
      "snippet": "                Alert.alert('Info', result.message);\n            }\n        } catch (error: any) {\n            Alert.alert('Error', error.message || 'Failed to send request');\n        }",
      "suggestion": "Replace with user-friendly generic messages. Example: \"An error occurred. Please try again.\" Log details securely."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Catch block shows raw error message to user - may expose sensitive backend details",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/FriendsModal.tsx",
      "line": 202,
      "snippet": "            await acceptFriendRequest(request.id, currentUserId, request.fromUid);\n            loadFriendData();\n        } catch (error: any) {\n            console.error('[FriendsModal] Accept failed:', error);\n            Alert.alert('Error', error.message || 'Failed to accept request');",
      "suggestion": "Replace with user-friendly generic messages. Example: \"An error occurred. Please try again.\" Log details securely."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/FriendsModal.tsx",
      "line": 203,
      "snippet": "            loadFriendData();\n        } catch (error: any) {\n            console.error('[FriendsModal] Accept failed:', error);\n            Alert.alert('Error', error.message || 'Failed to accept request');\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/FriendsModal.tsx",
      "line": 284,
      "snippet": "            }\n        } catch (error) {\n            console.error('Scan error:', error);\n            setScanned(false);\n        } finally {",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/ManageVisibilityModal.tsx",
      "line": 62,
      "snippet": "            await updatePinVisibility(currentUserId, friendUid, !currentlyHidden);\n        } catch (error) {\n            console.error('Failed to toggle visibility:', error);\n            // Revert on error\n            setHiddenFriendIds(prev =>",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/ProfileModal.tsx",
      "line": 258,
      "snippet": "            await toggleHiddenFriend(currentUserId, userId, !isHidden);\n        } catch (error) {\n            console.error('Failed to toggle hide pins:', error);\n            toggleHiddenFriendLocal(userId); // Revert on error\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/ReportModal.tsx",
      "line": 93,
      "snippet": "            setDescription('');\n        } catch (error) {\n            console.error('Error submitting report:', error);\n            Alert.alert('Error', 'Failed to submit report. Please try again.');\n        } finally {",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Sensitive Data: [Settings] Biometric Enable Error:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/SettingsModal.tsx",
      "line": 166,
      "snippet": "\n        } catch (error: any) {\n            console.error('[Settings] Biometric Enable Error:', error);\n            if (error.code === 'auth/wrong-password') {\n                setBiometricError('Incorrect password');",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Password/Credentials: Change password failed:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/SettingsModal.tsx",
      "line": 511,
      "snippet": "            setConfirmPassword('');\n        } catch (error: any) {\n            console.error('Change password failed:', error);\n            if (error.code === 'auth/wrong-password' || error.message?.includes('Incorrect')) {\n                setChangePasswordError('Current password is incorrect');",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/SettingsModal.tsx",
      "line": 166,
      "snippet": "\n        } catch (error: any) {\n            console.error('[Settings] Biometric Enable Error:', error);\n            if (error.code === 'auth/wrong-password') {\n                setBiometricError('Incorrect password');",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/SettingsModal.tsx",
      "line": 367,
      "snippet": "                await updateNotificationSettings(user.uid, { globalEnabled: value });\n            } catch (error: any) {\n                console.error('[Settings] Failed to toggle push notifications:', error);\n                // Revert on failure\n                setPushEnabled(previousValue);",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/SettingsModal.tsx",
      "line": 402,
      "snippet": "                useMemoryStore.getState().setFriends(currentFriends.filter(id => id !== friendUid));\n            } catch (error) {\n                console.error('[SettingsModal] Failed to remove friend:', error);\n                Alert.alert('Error', 'Failed to remove friend. Please try again.');\n            }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/SettingsModal.tsx",
      "line": 511,
      "snippet": "            setConfirmPassword('');\n        } catch (error: any) {\n            console.error('Change password failed:', error);\n            if (error.code === 'auth/wrong-password' || error.message?.includes('Incorrect')) {\n                setChangePasswordError('Current password is incorrect');",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Catch block shows raw error message to user - may expose sensitive backend details",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/SettingsModal.tsx",
      "line": 570,
      "snippet": "            onClose();\n\n        } catch (error: any) {\n            console.error('Delete failed:', error);\n            if (error.code === 'auth/wrong-password') {",
      "suggestion": "Replace with user-friendly generic messages. Example: \"An error occurred. Please try again.\" Log details securely."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/SettingsModal.tsx",
      "line": 571,
      "snippet": "\n        } catch (error: any) {\n            console.error('Delete failed:', error);\n            if (error.code === 'auth/wrong-password') {\n                setDeleteError('Incorrect password');",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Payment/Financial Data: [StoryCreation] Single pin error:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/StoryCreationFlow.tsx",
      "line": 344,
      "snippet": "                handleClose();\n            } catch (error) {\n                console.error('[StoryCreation] Single pin error:', error);\n                Alert.alert('Error', 'Failed to create pin. Please try again.');\n            } finally {",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/StoryCreationFlow.tsx",
      "line": 220,
      "snippet": "        } catch (error: any) {\n            if (error.code !== 'E_PICKER_CANCELLED') {\n                console.error('[StoryCreation] Photo picker error:', error);\n                Alert.alert('Error', 'Failed to select photos');\n            }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/StoryCreationFlow.tsx",
      "line": 274,
      "snippet": "            setLocationSuggestions(results);\n        } catch (error) {\n            console.error('[StoryCreation] Location search error:', error);\n        } finally {\n            setIsSearchingLocation(false);",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/StoryCreationFlow.tsx",
      "line": 344,
      "snippet": "                handleClose();\n            } catch (error) {\n                console.error('[StoryCreation] Single pin error:', error);\n                Alert.alert('Error', 'Failed to create pin. Please try again.');\n            } finally {",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/StoryCreationFlow.tsx",
      "line": 541,
      "snippet": "            handleClose();\n        } catch (error) {\n            console.error('[StoryCreation] Submit error:', error);\n            Alert.alert('Error', 'Failed to create journey. Please try again.');\n        } finally {",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/StoryCreationFlow.tsx",
      "line": 614,
      "snippet": "                                                        } catch (error: any) {\n                                                            if (error.code !== 'E_PICKER_CANCELLED') {\n                                                                console.error('[StoryCreationFlow] Error opening native editor:', error);\n                                                                Alert.alert('Error', 'Failed to open photo editor');\n                                                            }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "TEXT_INPUT_NO_SECURE",
      "description": "TextInput for pin without secureTextEntry property",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/StoryCreationFlow.tsx",
      "line": 699,
      "snippet": "                            <View style={styles.inputGroup}>\n                                <Text style={styles.inputLabel}>Title *</Text>\n                                <TextInput\n                                    style={styles.textInput}\n                                    placeholder=\"Give this pin a name\"",
      "suggestion": "Add secureTextEntry={true} to hide sensitive input and prevent screen recording/screenshots of this field"
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/components/UsernameModal.tsx",
      "line": 60,
      "snippet": "\n        } catch (err) {\n            console.error('[UsernameModal] Save error:', err);\n            setError('An error occurred. Please try again.');\n            setIsChecking(false);",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/config/firestore.ts",
      "line": 46,
      "snippet": "            configurationSucceeded = true;\n        } else {\n            console.error('[FirestoreConfig] âŒ Failed to configure Firestore:', error);\n        }\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Authentication Token: [Config] CRITICAL: EXPO_PUBLIC_MAPBOX_TOKEN enviro...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/constants/Config.ts",
      "line": 3,
      "snippet": "const token = process.env.EXPO_PUBLIC_MAPBOX_TOKEN;\nif (!token) {\n    console.error('[Config] CRITICAL: EXPO_PUBLIC_MAPBOX_TOKEN environment variable is not set!');\n}\nexport const MAPBOX_TOKEN = token || '';",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/hooks/useBanCheck.ts",
      "line": 58,
      "snippet": "                    }\n                } catch (error) {\n                    console.error('[useBanCheck] Error checking ban status:', error);\n                }\n            } catch (error) {",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/hooks/useBanCheck.ts",
      "line": 61,
      "snippet": "                }\n            } catch (error) {\n                console.error('[useBanCheck] Error in ban check:', error);\n            } finally {\n                setIsChecking(false);",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/hooks/useDataSubscriptions.ts",
      "line": 171,
      "snippet": "                    }\n                } catch (err) {\n                    console.warn('[useDataSubscriptions] Store sync failed:', err);\n                }\n            }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/hooks/useMapClusters.ts",
      "line": 53,
      "snippet": "                setClusters(clusteredPoints);\n            } catch (error) {\n                console.warn('[useMapClusters] Failed to get clusters:', error);\n                setClusters([]);\n            }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/ChallengeService.ts",
      "line": 98,
      "snippet": "            return challenge;\n        } catch (error) {\n            console.error('[ChallengeService] Failed to create challenge:', error);\n            return null;\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/ChallengeService.ts",
      "line": 116,
      "snippet": "            return true;\n        } catch (error) {\n            console.error('[ChallengeService] Failed to accept challenge:', error);\n            return false;\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/ChallengeService.ts",
      "line": 148,
      "snippet": "            return true;\n        } catch (error) {\n            console.error('[ChallengeService] Failed to start challenge attempt:', error);\n            return false;\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/ChallengeService.ts",
      "line": 206,
      "snippet": "            };\n        } catch (error: any) {\n            console.error('[ChallengeService] Failed to submit score:', error);\n            // Handle specific Cloud Function errors\n            if (error.code === 'functions/failed-precondition') {",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/ChallengeService.ts",
      "line": 224,
      "snippet": "            return { id: doc.id, ...doc.data() } as GameChallenge;\n        } catch (error) {\n            console.error('[ChallengeService] Failed to get challenge:', error);\n            return null;\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/ChallengeService.ts",
      "line": 253,
      "snippet": "                .sort((a, b) => b.createdAt - a.createdAt);\n        } catch (error) {\n            console.error('[ChallengeService] Failed to get pending challenges:', error);\n            return [];\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/ChallengeService.ts",
      "line": 279,
      "snippet": "                },\n                (error) => {\n                    console.error('[ChallengeService] Subscription error:', error);\n                }\n            );",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/ChallengeService.ts",
      "line": 310,
      "snippet": "            return Array.from(unique.values()).sort((a, b) => b.createdAt - a.createdAt);\n        } catch (error) {\n            console.error('[ChallengeService] Failed to get active challenges:', error);\n            return [];\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/GameService.ts",
      "line": 283,
      "snippet": "            logger.log('[GameService] Server score submission:', result.data);\n        } catch (error) {\n            console.error('[GameService] Failed to submit score to server:', error);\n            // Fallback: Score is still saved locally, just not on leaderboard\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/LeaderboardService.ts",
      "line": 75,
      "snippet": "            return entries.slice(0, limit);\n        } catch (error) {\n            console.error('[LeaderboardService] Failed to get friends leaderboard:', error);\n            return [];\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/LeaderboardService.ts",
      "line": 150,
      "snippet": "            return totals.slice(0, limit);\n        } catch (error) {\n            console.error('[LeaderboardService] Failed to get total leaderboard:', error);\n            return [];\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/LeaderboardService.ts",
      "line": 168,
      "snippet": "            return snapshot.docs.map(doc => doc.data() as LeaderboardEntry);\n        } catch (error) {\n            console.error('[LeaderboardService] Failed to get global leaderboard:', error);\n            return [];\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/ModerationService.ts",
      "line": 20,
      "snippet": "        return result.data as ModerationResult;\n    } catch (error: any) {\n        console.error('Image moderation error:', error);\n        // Fail open on error - allow the image but log\n        return { approved: true, reason: null, error: error.message };",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/NotificationService.ts",
      "line": 251,
      "snippet": "\n            steps.push('Sending request to OneSignal API...');\n            const response = await fetch('https://onesignal.com/api/v1/notifications', {\n                method: 'POST',\n                headers: {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/NotificationService.ts",
      "line": 311,
      "snippet": "\n        try {\n            const response = await fetch('https://onesignal.com/api/v1/notifications', {\n                method: 'POST',\n                headers: {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/NotificationService.ts",
      "line": 367,
      "snippet": "\n        try {\n            const response = await fetch('https://onesignal.com/api/v1/notifications', {\n                method: 'POST',\n                headers: {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/NotificationService.ts",
      "line": 426,
      "snippet": "            }\n\n            const response = await fetch('https://onesignal.com/api/v1/notifications', {\n                method: 'POST',\n                headers: {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging API Key/Secret: [NotificationService] CRITICAL: EXPO_PUBLIC_ONESIG...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/NotificationService.ts",
      "line": 26,
      "snippet": "// Debug: Log key status (without exposing the full key)\nif (!ONE_SIGNAL_REST_API_KEY) {\n    console.error('[NotificationService] CRITICAL: EXPO_PUBLIC_ONESIGNAL_REST_API_KEY environment variable is not set!');\n} else {\n    // Log first 10 chars and last 4 chars for verification (safe to log)",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging API Key/Secret: `[NotificationService] OneSignal REST API Key loaded: ${keyP...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/NotificationService.ts",
      "line": 32,
      "snippet": "        ? `${ONE_SIGNAL_REST_API_KEY.substring(0, 10)}...${ONE_SIGNAL_REST_API_KEY.substring(ONE_SIGNAL_REST_API_KEY.length - 4)}`\n        : '***';\n    console.log(`[NotificationService] OneSignal REST API Key loaded: ${keyPreview} (length: ${ONE_SIGNAL_REST_API_KEY.length})`);\n\n    // Verify key format (should start with 'os_' or be a long alphanumeric string)",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Authentication Token: [OneSignal] DISABLED or not available - returning ...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/NotificationService.ts",
      "line": 180,
      "snippet": "    async registerForPushNotificationsAsync() {\n        if (ONESIGNAL_DISABLED || !OneSignal) {\n            console.log('[OneSignal] DISABLED or not available - returning null token');\n            return null;\n        }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: `[NotificationService] Pin notifications disabled for ${frie...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/NotificationService.ts",
      "line": 362,
      "snippet": "\n        if (!isGlobalEnabled || !isPinsEnabled) {\n            console.log(`[NotificationService] Pin notifications disabled for ${friendUid}`);\n            return;\n        }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Payment/Financial Data: `[NotificationService] Failed to send pin notification:`",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/NotificationService.ts",
      "line": 392,
      "snippet": "\n            if (!response.ok || result.errors) {\n                console.error(`[NotificationService] Failed to send pin notification:`, result.errors || `HTTP ${response.status}`);\n            } else if (result.recipients === 0) {\n                console.warn(`[NotificationService] Pin notification sent but no recipients found for ${friendUid}. User may not be subscribed or external_id not set.`);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.warn() logging Payment/Financial Data: `[NotificationService] Pin notification sent but no recipien...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/NotificationService.ts",
      "line": 394,
      "snippet": "                console.error(`[NotificationService] Failed to send pin notification:`, result.errors || `HTTP ${response.status}`);\n            } else if (result.recipients === 0) {\n                console.warn(`[NotificationService] Pin notification sent but no recipients found for ${friendUid}. User may not be subscribed or external_id not set.`);\n            } else {\n                console.log(`[NotificationService] Pin notification sent successfully to ${result.recipients} recipient(s)`);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: `[NotificationService] Pin notification sent successfully to...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/NotificationService.ts",
      "line": 396,
      "snippet": "                console.warn(`[NotificationService] Pin notification sent but no recipients found for ${friendUid}. User may not be subscribed or external_id not set.`);\n            } else {\n                console.log(`[NotificationService] Pin notification sent successfully to ${result.recipients} recipient(s)`);\n            }\n        } catch (error) {",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Payment/Financial Data: [NotificationService] Error notifying new pin:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/NotificationService.ts",
      "line": 399,
      "snippet": "            }\n        } catch (error) {\n            console.error('[NotificationService] Error notifying new pin:', error);\n        }\n    },",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/NotificationService.ts",
      "line": 340,
      "snippet": "            }\n        } catch (error) {\n            console.error('[NotificationService] Error notifying challenge complete:', error);\n        }\n    },",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/NotificationService.ts",
      "line": 399,
      "snippet": "            }\n        } catch (error) {\n            console.error('[NotificationService] Error notifying new pin:', error);\n        }\n    },",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/NotificationService.ts",
      "line": 459,
      "snippet": "            }\n        } catch (error) {\n            console.error('[NotificationService] Error notifying new story:', error);\n        }\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/RestService.ts",
      "line": 92,
      "snippet": "\nasync function runQuery(token: string, queryBody: any): Promise<GameChallenge[]> {\n    const response = await fetch(BASE_URL, {\n        method: 'POST',\n        headers: {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.warn() logging Authentication Token: [RestService] No auth token available",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/RestService.ts",
      "line": 16,
      "snippet": "            const token = await auth().currentUser?.getIdToken();\n            if (!token) {\n                console.warn('[RestService] No auth token available');\n                return { active: [], pending: [] };\n            }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/RestService.ts",
      "line": 85,
      "snippet": "\n        } catch (error) {\n            console.error('[RestService] REST fetch failed:', error);\n            return { active: [], pending: [] };\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: [ShareService] Pin shared successfully",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/ShareService.ts",
      "line": 52,
      "snippet": "            });\n\n            console.log('[ShareService] Pin shared successfully');\n            return true;\n        } catch (error) {",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Payment/Financial Data: [ShareService] Share pin failed:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/ShareService.ts",
      "line": 55,
      "snippet": "            return true;\n        } catch (error) {\n            console.error('[ShareService] Share pin failed:', error);\n            return false;\n        }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/ShareService.ts",
      "line": 33,
      "snippet": "            return true;\n        } catch (error) {\n            console.error('[ShareService] Share app invite failed:', error);\n            return false;\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/ShareService.ts",
      "line": 55,
      "snippet": "            return true;\n        } catch (error) {\n            console.error('[ShareService] Share pin failed:', error);\n            return false;\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/ShareService.ts",
      "line": 75,
      "snippet": "            return true;\n        } catch (error) {\n            console.error('[ShareService] Share journey failed:', error);\n            return false;\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/ShareService.ts",
      "line": 114,
      "snippet": "            return true;\n        } catch (error) {\n            console.error('[ShareService] Share game score failed:', error);\n            return false;\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/StoryService.ts",
      "line": 411,
      "snippet": "\n                        const url = `https://firestore.googleapis.com/v1/projects/${projectId}/databases/(default)/documents:runQuery`;\n                        const response = await fetch(url, {\n                            method: 'POST',\n                            headers: {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: [StoryService] Created pin:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/StoryService.ts",
      "line": 122,
      "snippet": "\n                    const newPinId = await addPin(pinData as any);\n                    console.log('[StoryService] Created pin:', newPinId);\n                    return newPinId;\n                } catch (pinError) {",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Payment/Financial Data: [StoryService] Error creating pin:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/StoryService.ts",
      "line": 125,
      "snippet": "                    return newPinId;\n                } catch (pinError) {\n                    console.error('[StoryService] Error creating pin:', pinError);\n                    return null;\n                }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Payment/Financial Data: [StoryService] Error creating new pin for update:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/StoryService.ts",
      "line": 209,
      "snippet": "                        return newPinId;\n                    } catch (e) {\n                        console.error('[StoryService] Error creating new pin for update:', e);\n                        return null;\n                    }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Payment/Financial Data: [StoryService] Error updating pin:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/StoryService.ts",
      "line": 228,
      "snippet": "                    });\n                } catch (e) {\n                    console.error('[StoryService] Error updating pin:', draft.tempId, e);\n                }\n            });",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: `[StoryService] Deleting ${story.pinIds.length} pins for sto...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/StoryService.ts",
      "line": 289,
      "snippet": "            // 2. Delete all associated pins\n            if (story.pinIds && story.pinIds.length > 0) {\n                console.log(`[StoryService] Deleting ${story.pinIds.length} pins for story ${storyId}`);\n                await Promise.all(story.pinIds.map(pinId => deletePin(pinId).catch(e => {\n                    console.warn(`[StoryService] Failed to delete pin ${pinId}:`, e);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.warn() logging Payment/Financial Data: `[StoryService] Failed to delete pin ${pinId}:`",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/StoryService.ts",
      "line": 291,
      "snippet": "                console.log(`[StoryService] Deleting ${story.pinIds.length} pins for story ${storyId}`);\n                await Promise.all(story.pinIds.map(pinId => deletePin(pinId).catch(e => {\n                    console.warn(`[StoryService] Failed to delete pin ${pinId}:`, e);\n                })));\n            }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/StoryService.ts",
      "line": 57,
      "snippet": "\n        } catch (error: any) {\n            console.error('[StoryService] Error creating story:', error);\n            // Handle specific error codes\n            if (error.code === 'functions/resource-exhausted') {",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/StoryService.ts",
      "line": 160,
      "snippet": "\n        } catch (error) {\n            console.error('[StoryService] Error in batch story creation:', error);\n            return { success: false, error: 'Failed to create story.' };\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/StoryService.ts",
      "line": 251,
      "snippet": "\n        } catch (error) {\n            console.error('[StoryService] Error in updateStoryWithPhotos:', error);\n            return { success: false, error: 'Failed to update story.' };\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/StoryService.ts",
      "line": 273,
      "snippet": "            return { success: true };\n        } catch (error) {\n            console.error('[StoryService] Error updating story:', error);\n            return { success: false, error: 'Failed to update story.' };\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/StoryService.ts",
      "line": 300,
      "snippet": "            return true;\n        } catch (error) {\n            console.error('[StoryService] Error deleting story:', error);\n            return false;\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/StoryService.ts",
      "line": 318,
      "snippet": "            return snapshot.docs.map(doc => doc.data() as Story);\n        } catch (error) {\n            console.error('[StoryService] Error fetching user stories:', error);\n            return [];\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/StoryService.ts",
      "line": 334,
      "snippet": "            return null;\n        } catch (error) {\n            console.error('[StoryService] Error fetching story:', error);\n            return null;\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/StoryService.ts",
      "line": 470,
      "snippet": "                        console.log('[StoryService] Subscription ended (user logged out)');\n                    } else {\n                        console.error('[StoryService] Subscription error:', error);\n                    }\n                }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Authentication Token: [AuthService] âŒ No ID token returned from Google S...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 99,
      "snippet": "\n            if (!idToken) {\n                console.error('[AuthService] âŒ No ID token returned from Google Sign-In');\n                throw new Error('No ID token returned from Google Sign-In');\n            }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Authentication Token: [AuthService] âœ… ID token received (length:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 102,
      "snippet": "                throw new Error('No ID token returned from Google Sign-In');\n            }\n            console.log('[AuthService] âœ… ID token received (length:', idToken.length, ')');\n\n            // Create a Google credential with the token",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Sensitive Data: [AuthService] ğŸ”‘ Creating Google credential...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 105,
      "snippet": "\n            // Create a Google credential with the token\n            console.log('[AuthService] ğŸ”‘ Creating Google credential...');\n            const googleCredential = auth.GoogleAuthProvider.credential(idToken);\n            console.log('[AuthService] âœ… Credential created');",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Sensitive Data: [AuthService] âœ… Credential created",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 107,
      "snippet": "            console.log('[AuthService] ğŸ”‘ Creating Google credential...');\n            const googleCredential = auth.GoogleAuthProvider.credential(idToken);\n            console.log('[AuthService] âœ… Credential created');\n\n            // Sign-in the user with the credential - this will throw if Firebase isn't ready",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Sensitive Data: [AuthService] ğŸ” Signing in with credential...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 110,
      "snippet": "\n            // Sign-in the user with the credential - this will throw if Firebase isn't ready\n            console.log('[AuthService] ğŸ” Signing in with credential...');\n            const credentialStartTime = Date.now();\n            const userCredential = await auth().signInWithCredential(googleCredential);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Sensitive Data: [AuthService] âœ… Sign-in with credential succeeded",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 114,
      "snippet": "            const userCredential = await auth().signInWithCredential(googleCredential);\n            const credentialDuration = Date.now() - credentialStartTime;\n            console.log('[AuthService] âœ… Sign-in with credential succeeded');\n            console.log('[AuthService] Credential sign-in duration:', credentialDuration + 'ms');\n            console.log('[AuthService] User ID:', userCredential.user.uid);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Sensitive Data: [AuthService] Credential sign-in duration:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 115,
      "snippet": "            const credentialDuration = Date.now() - credentialStartTime;\n            console.log('[AuthService] âœ… Sign-in with credential succeeded');\n            console.log('[AuthService] Credential sign-in duration:', credentialDuration + 'ms');\n            console.log('[AuthService] User ID:', userCredential.user.uid);\n            console.log('[AuthService] User email:', userCredential.user.email);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Personal Identifiable Information (PII): [AuthService] User email:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 117,
      "snippet": "            console.log('[AuthService] Credential sign-in duration:', credentialDuration + 'ms');\n            console.log('[AuthService] User ID:', userCredential.user.uid);\n            console.log('[AuthService] User email:', userCredential.user.email);\n            console.log('[AuthService] Display name:', userCredential.user.displayName);\n            console.log('[AuthService] Is new user:', userCredential.additionalUserInfo?.isNewUser ?? false);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Sensitive Data: [AuthService] ğŸ”‘ Creating Apple credential...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 221,
      "snippet": "\n        // Create a Firebase credential with the Apple ID token\n        console.log('[AuthService] ğŸ”‘ Creating Apple credential...');\n        console.log('[AuthService] Identity token length:', identityToken?.length || 0);\n        console.log('[AuthService] Nonce length:', nonce?.length || 0);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Authentication Token: [AuthService] Identity token length:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 222,
      "snippet": "        // Create a Firebase credential with the Apple ID token\n        console.log('[AuthService] ğŸ”‘ Creating Apple credential...');\n        console.log('[AuthService] Identity token length:', identityToken?.length || 0);\n        console.log('[AuthService] Nonce length:', nonce?.length || 0);\n        ",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Sensitive Data: [AuthService] âœ… Credential created",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 228,
      "snippet": "        try {\n            firebaseCredential = auth.AppleAuthProvider.credential(identityToken, nonce);\n            console.log('[AuthService] âœ… Credential created');\n        } catch (credError: any) {\n            console.error('[AuthService] âŒ Failed to create Firebase credential:', credError);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Sensitive Data: [AuthService] âŒ Failed to create Firebase credenti...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 230,
      "snippet": "            console.log('[AuthService] âœ… Credential created');\n        } catch (credError: any) {\n            console.error('[AuthService] âŒ Failed to create Firebase credential:', credError);\n            console.error('[AuthService] Credential error code:', credError.code);\n            console.error('[AuthService] Credential error message:', credError.message);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Sensitive Data: [AuthService] Credential error code:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 231,
      "snippet": "        } catch (credError: any) {\n            console.error('[AuthService] âŒ Failed to create Firebase credential:', credError);\n            console.error('[AuthService] Credential error code:', credError.code);\n            console.error('[AuthService] Credential error message:', credError.message);\n            throw new Error(`Failed to create authentication credential: ${credError.message || 'Unknown error'}`);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Sensitive Data: [AuthService] Credential error message:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 232,
      "snippet": "            console.error('[AuthService] âŒ Failed to create Firebase credential:', credError);\n            console.error('[AuthService] Credential error code:', credError.code);\n            console.error('[AuthService] Credential error message:', credError.message);\n            throw new Error(`Failed to create authentication credential: ${credError.message || 'Unknown error'}`);\n        }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Sensitive Data: [AuthService] ğŸ” Signing in with credential...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 237,
      "snippet": "\n        // Sign in the user with the credential\n        console.log('[AuthService] ğŸ” Signing in with credential...');\n        let userCredential;\n        try {",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Sensitive Data: [AuthService] âœ… Sign-in with credential succeeded",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 241,
      "snippet": "        try {\n            userCredential = await auth().signInWithCredential(firebaseCredential);\n            console.log('[AuthService] âœ… Sign-in with credential succeeded');\n        } catch (signInError: any) {\n            console.error('[AuthService] âŒ Firebase sign-in failed:', signInError);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Password/Credentials: [AuthService] Account linked with email/password",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 308,
      "snippet": "        if (currentUser) {\n            await currentUser.linkWithCredential(credential);\n            console.log('[AuthService] Account linked with email/password');\n        } else {\n            throw new Error('No user currently signed in');",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Personal Identifiable Information (PII): [AuthService] Email:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 333,
      "snippet": "export const signInEmailPassword = async (email: string, password: string): Promise<string> => {\n    console.log('[AuthService] ========== signInEmailPassword START ==========');\n    console.log('[AuthService] Email:', email);\n    console.log('[AuthService] Password length:', password.length);\n",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Password/Credentials: [AuthService] Password length:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 334,
      "snippet": "    console.log('[AuthService] ========== signInEmailPassword START ==========');\n    console.log('[AuthService] Email:', email);\n    console.log('[AuthService] Password length:', password.length);\n\n    // Try to ensure Firebase is ready, but don't block if it fails",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Personal Identifiable Information (PII): [AuthService] User email:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 357,
      "snippet": "            console.log('[AuthService] Sign-in duration:', signInDuration + 'ms');\n            console.log('[AuthService] User ID:', userId);\n            console.log('[AuthService] User email:', userCredential.user.email);\n\n            // Wait a moment for auth state to propagate",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Sensitive Data: [AuthService] âŒ Invalid credentials",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 405,
      "snippet": "            // Handle auth errors\n            if (error.code === 'auth/user-not-found' || error.code === 'auth/wrong-password' || error.code === 'auth/invalid-credential') {\n                console.error('[AuthService] âŒ Invalid credentials');\n                throw new Error('Invalid email or password.');\n            } else if (error.code === 'auth/invalid-email') {",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Personal Identifiable Information (PII): [AuthService] âŒ Invalid email format",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 408,
      "snippet": "                throw new Error('Invalid email or password.');\n            } else if (error.code === 'auth/invalid-email') {\n                console.error('[AuthService] âŒ Invalid email format');\n                throw new Error('Invalid email address.');\n            }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Password/Credentials: [AuthService] Password reset email sent to:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 433,
      "snippet": "\n        await auth().sendPasswordResetEmail(email);\n        console.log('[AuthService] Password reset email sent to:', email);\n    } catch (error: any) {\n        console.error('[AuthService] Password reset failed:', error);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Password/Credentials: [AuthService] Password reset failed:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 435,
      "snippet": "        console.log('[AuthService] Password reset email sent to:', email);\n    } catch (error: any) {\n        console.error('[AuthService] Password reset failed:', error);\n        if (error.code === 'auth/user-not-found') {\n            // Don't reveal if user exists or not for security, or handle UI specific",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Password/Credentials: [AuthService] Password updated",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 458,
      "snippet": "        if (currentUser) {\n            await currentUser.updatePassword(newPassword);\n            console.log('[AuthService] Password updated');\n        } else {\n            throw new Error('No user currently signed in');",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Password/Credentials: [AuthService] Update password failed:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 463,
      "snippet": "        }\n    } catch (error: any) {\n        console.error('[AuthService] Update password failed:', error);\n        if (error.code === 'auth/requires-recent-login') {\n            throw new Error('Please sign out and sign in again to change your password.');",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 17,
      "snippet": "    });\n} catch (error) {\n    console.warn('[AuthService] Failed to configure Google Sign-In:', error);\n}\n",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 32,
      "snippet": "        return;\n    } catch (error) {\n        console.warn('[AuthService] Firebase wait failed, will retry on actual call:', error);\n        // Don't throw yet - we'll retry when actually calling Firebase\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 182,
      "snippet": "        Crypto = require('expo-crypto');\n    } catch (error: any) {\n        console.error('[AuthService] âŒ Failed to load Apple Sign-In modules:', error);\n        throw new Error('Apple Sign-In is not available. Please ensure expo-apple-authentication is installed and linked.');\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 275,
      "snippet": "        };\n    } catch (error: any) {\n        console.error('[AuthService] âŒ Apple Sign-In failed:', error);\n        console.error('[AuthService] Error code:', error.code);\n        console.error('[AuthService] Error message:', error.message);",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 277,
      "snippet": "        console.error('[AuthService] âŒ Apple Sign-In failed:', error);\n        console.error('[AuthService] Error code:', error.code);\n        console.error('[AuthService] Error message:', error.message);\n\n        if (error.code === 'ERR_REQUEST_CANCELED' || error.code === 'ERR_APPLE_AUTH_CANCELED') {",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 313,
      "snippet": "        }\n    } catch (error: any) {\n        console.error('[AuthService] Link failed:', error);\n        if (error.code === 'auth/credential-already-in-use') {\n            throw new Error('This email is already associated with another account.');",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 387,
      "snippet": "            console.error(`[AuthService] âŒ Sign-in attempt ${attempt + 1} failed`);\n            console.error('[AuthService] Error code:', error.code);\n            console.error('[AuthService] Error message:', error.message);\n\n            // Check if it's a Firebase initialization error",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 435,
      "snippet": "        console.log('[AuthService] Password reset email sent to:', email);\n    } catch (error: any) {\n        console.error('[AuthService] Password reset failed:', error);\n        if (error.code === 'auth/user-not-found') {\n            // Don't reveal if user exists or not for security, or handle UI specific",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 463,
      "snippet": "        }\n    } catch (error: any) {\n        console.error('[AuthService] Update password failed:', error);\n        if (error.code === 'auth/requires-recent-login') {\n            throw new Error('Please sign out and sign in again to change your password.');",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 501,
      "snippet": "            return;\n        }\n        console.error('[AuthService] âŒ Sign out failed:', error);\n        throw error;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 532,
      "snippet": "        return userCredential.user.uid;\n    } catch (error) {\n        console.error('[AuthService] Anonymous sign-in failed:', error);\n        return null;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 549,
      "snippet": "        return userCredential.user.uid;\n    } catch (error: any) {\n        console.error('[AuthService] Sign up failed:', error);\n        if (error.code === 'auth/email-already-in-use') {\n            throw new Error('That email address is already in use!');",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 574,
      "snippet": "        await waitForFirebase();\n    } catch (error) {\n        console.warn('[AuthService] Firebase wait failed, will retry on actual call:', error);\n    }\n",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 590,
      "snippet": "        } catch (error: any) {\n            lastError = error;\n            console.error(`[AuthService] Failed to subscribe to auth state (attempt ${attempt + 1}/5):`, error);\n\n            // Check if it's a Firebase initialization error",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "INSECURE_RANDOM",
      "description": "Math.random() used for security-sensitive random value generation",
      "severity": "HIGH",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/authService.ts",
      "line": 196,
      "snippet": "    try {\n        // Generate a secure nonce\n        const nonce = Math.random().toString(36).substring(2, 15);\n        const hashedNonce = await Crypto.digestStringAsync(\n            Crypto.CryptoDigestAlgorithm.SHA256,",
      "suggestion": "Use expo-random or crypto.getRandomValues() for cryptographically secure random values. Math.random() is not cryptographically secure."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/biometricService.ts",
      "line": 62,
      "snippet": "            await SecureStore.setItemAsync(KEY_PASSWORD, pass);\n        } catch (error) {\n            console.error('SecureStore Error:', error);\n            throw error;\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/biometricService.ts",
      "line": 80,
      "snippet": "            return null;\n        } catch (error) {\n            console.error('SecureStore Retrieval Error:', error);\n            return null;\n        }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/biometricService.ts",
      "line": 93,
      "snippet": "            await SecureStore.deleteItemAsync(KEY_PASSWORD);\n        } catch (error) {\n            console.error('SecureStore Clear Error:', error);\n        }\n    },",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "IMPROPER_BIOMETRIC_FALLBACK",
      "description": "Biometric authentication falls back to insecurely stored credentials",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/biometricService.ts",
      "line": 1,
      "suggestion": "Use proper fallback: require device passcode/pattern, or store fallback credentials in secure keychain/keystore, never in plaintext or AsyncStorage."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/firebaseInitService.ts",
      "line": 152,
      "snippet": "                        return;\n                    } else {\n                        console.error('[FirebaseInit] Error getting app:', error);\n                        isFirebaseReady = true;\n                        resolve();",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/firebaseInitService.ts",
      "line": 209,
      "snippet": "                        return;\n                    } else {\n                        console.error('[FirebaseInit] Firebase initialization timeout:', error);\n                        isFirebaseReady = true;\n                        resolve();",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/firebaseInitService.ts",
      "line": 220,
      "snippet": "                        return;\n                    } else {\n                        console.error('[FirebaseInit] Unexpected error after timeout:', error);\n                        isFirebaseReady = true;\n                        resolve();",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Catch block shows raw error message to user - may expose sensitive backend details",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/firebaseInitService.ts",
      "line": 305,
      "snippet": "                    return;\n                }\n            } catch (error: any) {\n                console.warn('[FirebaseInit] Firestore check error:', error);\n",
      "suggestion": "Replace with user-friendly generic messages. Example: \"An error occurred. Please try again.\" Log details securely."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/firebaseInitService.ts",
      "line": 306,
      "snippet": "                }\n            } catch (error: any) {\n                console.warn('[FirebaseInit] Firestore check error:', error);\n\n                // For critical errors, retry a few times then give up",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "API_KEY_EXPOSED",
      "description": "Firebase API key detected: AIzaSyAUKW5TCvDSYK_G...[REDACTED]",
      "severity": "HIGH",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/firebaseInitService.ts",
      "line": 110,
      "snippet": "                                // This is a fallback if native configure didn't work\n                                const firebaseConfig = {\n                                    apiKey: \"AIzaSyAUKW5TCvDSYK_G-T9CuxVGaCeYv57ikBE\",\n                                    projectId: \"days-c4ad4\",\n                                    storageBucket: \"days-c4ad4.firebasestorage.app\",",
      "suggestion": "Move Firebase API Key to environment variables or secure config management. Never commit secrets to version control."
    },
    {
      "ruleId": "API_KEY_EXPOSED",
      "description": "Generic API key pattern detected: apiKey: \"AIzaSyAUKW5...[REDACTED]",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/firebaseInitService.ts",
      "line": 110,
      "snippet": "                                // This is a fallback if native configure didn't work\n                                const firebaseConfig = {\n                                    apiKey: \"AIzaSyAUKW5TCvDSYK_G-T9CuxVGaCeYv57ikBE\",\n                                    projectId: \"days-c4ad4\",\n                                    storageBucket: \"days-c4ad4.firebasestorage.app\",",
      "suggestion": "Move Generic API Key to environment variables or secure config management. Never commit secrets to version control."
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/firestoreService.ts",
      "line": 190,
      "snippet": "\n                            const url = `https://firestore.googleapis.com/v1/projects/${projectId}/databases/(default)/documents:runQuery`;\n                            const response = await fetch(url, {\n                                method: 'POST',\n                                headers: {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: [Firestore] Pin added:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/firestoreService.ts",
      "line": 42,
      "snippet": "\n        const docRef = await firestore().collection(PINS_COLLECTION).add(pinData);\n        console.log('[Firestore] Pin added:', docRef.id);\n\n",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Payment/Financial Data: [Firestore] Add pin failed:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/firestoreService.ts",
      "line": 48,
      "snippet": "        return docRef.id;\n    } catch (error) {\n        console.error('[Firestore] Add pin failed:', error);\n        throw error;\n    }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: [Firestore] Pin deleted:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/firestoreService.ts",
      "line": 59,
      "snippet": "    try {\n        await firestore().collection(PINS_COLLECTION).doc(pinId).delete();\n        console.log('[Firestore] Pin deleted:', pinId);\n    } catch (error) {\n        console.error('[Firestore] Delete pin failed:', error);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Payment/Financial Data: [Firestore] Delete pin failed:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/firestoreService.ts",
      "line": 61,
      "snippet": "        console.log('[Firestore] Pin deleted:', pinId);\n    } catch (error) {\n        console.error('[Firestore] Delete pin failed:', error);\n        throw error;\n    }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: [Firestore] Pin updated:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/firestoreService.ts",
      "line": 89,
      "snippet": "\n        await firestore().collection(PINS_COLLECTION).doc(pinId).update(pinUpdates);\n        console.log('[Firestore] Pin updated:', pinId);\n    } catch (error) {\n        console.error('[Firestore] Update pin failed:', error);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Payment/Financial Data: [Firestore] Update pin failed:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/firestoreService.ts",
      "line": 91,
      "snippet": "        console.log('[Firestore] Pin updated:', pinId);\n    } catch (error) {\n        console.error('[Firestore] Update pin failed:', error);\n        throw error;\n    }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.warn() logging Payment/Financial Data: Failed to delete expired pin:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/firestoreService.ts",
      "line": 144,
      "snippet": "            console.log('[Firestore] Found expired pins (cleanup):', expiredPinIds.length);\n            // We don't wait for this; fire and forget\n            expiredPinIds.forEach(id => deletePin(id).catch(err => console.warn('Failed to delete expired pin:', id, err)));\n        }\n",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/firestoreService.ts",
      "line": 48,
      "snippet": "        return docRef.id;\n    } catch (error) {\n        console.error('[Firestore] Add pin failed:', error);\n        throw error;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/firestoreService.ts",
      "line": 61,
      "snippet": "        console.log('[Firestore] Pin deleted:', pinId);\n    } catch (error) {\n        console.error('[Firestore] Delete pin failed:', error);\n        throw error;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/firestoreService.ts",
      "line": 91,
      "snippet": "        console.log('[Firestore] Pin updated:', pinId);\n    } catch (error) {\n        console.error('[Firestore] Update pin failed:', error);\n        throw error;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/firestoreService.ts",
      "line": 144,
      "snippet": "            console.log('[Firestore] Found expired pins (cleanup):', expiredPinIds.length);\n            // We don't wait for this; fire and forget\n            expiredPinIds.forEach(id => deletePin(id).catch(err => console.warn('Failed to delete expired pin:', id, err)));\n        }\n",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/firestoreService.ts",
      "line": 247,
      "snippet": "                        }\n                    } catch (error: any) {\n                        console.error('[Firestore] âŒ REST query failed:', error);\n                        callback([]);\n                    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/firestoreService.ts",
      "line": 272,
      "snippet": "                    },\n                    (error) => {\n                        console.error('[Firestore] âŒ Pins snapshot error:', error);\n                        console.error('[Firestore] Error code:', error.code);\n                        console.error('[Firestore] Error message:', error.message);",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/firestoreService.ts",
      "line": 274,
      "snippet": "                        console.error('[Firestore] âŒ Pins snapshot error:', error);\n                        console.error('[Firestore] Error code:', error.code);\n                        console.error('[Firestore] Error message:', error.message);\n                        // Call callback with empty array on error to prevent hang\n                        callback([]);",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/firestoreService.ts",
      "line": 284,
      "snippet": "        })\n        .catch((error) => {\n            console.error('[Firestore] âŒ Failed to wait for Firestore:', error);\n            // Call callback with empty array to prevent hang\n            callback([]);",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout - vulnerable to slowloris DoS",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/geocodingService.ts",
      "line": 19,
      "snippet": "    try {\n        const url = `${MAPBOX_GEOCODING_API}/${encodeURIComponent(query)}.json?access_token=${MAPBOX_TOKEN}&types=place,country,locality&limit=5`;\n        const response = await fetch(url);\n\n        if (!response.ok) {",
      "suggestion": "Add timeout to fetch using AbortSignal with setTimeout, or use a library like axios with timeout config."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/geocodingService.ts",
      "line": 36,
      "snippet": "\n    } catch (error) {\n        console.error('[GeocodingService] Search failed:', error);\n        return [];\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/storageService.ts",
      "line": 33,
      "snippet": "        return result.uri;\n    } catch (error) {\n        console.warn('[Storage] Compression failed or module missing, using original:', error);\n        return uri; // Fallback to original if compression fails or module missing\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/storageService.ts",
      "line": 69,
      "snippet": "        return downloadUrl;\n    } catch (error) {\n        console.error('[Storage] Upload failed:', error);\n        throw error;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/storageService.ts",
      "line": 85,
      "snippet": "        console.log('[Storage] Image deleted');\n    } catch (error) {\n        console.error('[Storage] Delete failed:', error);\n        // Don't throw - image might not exist\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/unsplashService.ts",
      "line": 20,
      "snippet": "        console.log(`[UnsplashService] Searching for: ${query}`);\n        // Orientation landscape is best for cards\n        const response = await fetch(\n            `${UNSPLASH_BASE_URL}/search/photos?query=${encodeURIComponent(query)}&per_page=1&orientation=landscape`,\n            {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/unsplashService.ts",
      "line": 64,
      "snippet": "export const triggerDownload = async (downloadLocation: string) => {\n    try {\n        await fetch(downloadLocation, {\n            headers: {\n                'Authorization': `Client-ID ${UNSPLASH_ACCESS_KEY}`",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/unsplashService.ts",
      "line": 54,
      "snippet": "        return null;\n    } catch (error) {\n        console.error('[UnsplashService] Search Failed:', error);\n        return null;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 593,
      "snippet": "                    const url = `https://firestore.googleapis.com/v1/projects/${projectId}/databases/(default)/documents/users/${uid}`;\n\n                    const response = await fetch(url, {\n                        headers: { 'Authorization': `Bearer ${token}` }\n                    });",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Personal Identifiable Information (PII): [UserService] Get email failed:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 121,
      "snippet": "        return data.email || null;\n    } catch (error) {\n        console.error('[UserService] Get email failed:', error);\n        return null;\n    }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: [UserService] Pin color saved for:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 193,
      "snippet": "            updatedAt: firestore.Timestamp.now(),\n        }, { merge: true });\n        console.log('[UserService] Pin color saved for:', uid);\n        invalidateProfileCache(uid);\n    } catch (error) {",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Payment/Financial Data: [UserService] Save pin color failed:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 196,
      "snippet": "        invalidateProfileCache(uid);\n    } catch (error) {\n        console.error('[UserService] Save pin color failed:', error);\n        throw error;\n    }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Authentication Token: [UserService] Push token saved for:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 229,
      "snippet": "            updatedAt: firestore.Timestamp.now(),\n        }, { merge: true });\n        console.log('[UserService] Push token saved for:', uid);\n    } catch (error) {\n        console.error('[UserService] Save push token failed:', error);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Authentication Token: [UserService] Save push token failed:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 231,
      "snippet": "        console.log('[UserService] Push token saved for:', uid);\n    } catch (error) {\n        console.error('[UserService] Save push token failed:', error);\n        // Don't throw, just log. Not critical.\n    }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Payment/Financial Data: [UserService] Update pin visibility failed:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 260,
      "snippet": "        }\n    } catch (error) {\n        console.error('[UserService] Update pin visibility failed:', error);\n        throw error;\n    }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.log() logging Payment/Financial Data: `[UserService] Pin ${pinId} ${hide ? 'hidden' : 'shown'} for...",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 397,
      "snippet": "            updatedAt: firestore.Timestamp.now(),\n        });\n        console.log(`[UserService] Pin ${pinId} ${hide ? 'hidden' : 'shown'} for user ${uid}`);\n    } catch (error) {\n        console.error('[UserService] Toggle hidden pin failed:', error);",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_LOGGING",
      "description": "console.error() logging Payment/Financial Data: [UserService] Toggle hidden pin failed:",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 399,
      "snippet": "        console.log(`[UserService] Pin ${pinId} ${hide ? 'hidden' : 'shown'} for user ${uid}`);\n    } catch (error) {\n        console.error('[UserService] Toggle hidden pin failed:', error);\n        throw error;\n    }",
      "suggestion": "Remove console logs with sensitive data or wrap in __DEV__ check. Use a logging library with data filtering for production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 98,
      "snippet": "        return true;\n    } catch (error) {\n        console.error('[UserService] Check username failed:', error);\n        return false; // Assume available on error to not block user\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 121,
      "snippet": "        return data.email || null;\n    } catch (error) {\n        console.error('[UserService] Get email failed:', error);\n        return null;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 158,
      "snippet": "        invalidateProfileCache(uid);\n    } catch (error) {\n        console.error('[UserService] Save profile failed:', error);\n        throw error;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 178,
      "snippet": "        invalidateProfileCache(uid);\n    } catch (error) {\n        console.error('[UserService] Save avatar failed:', error);\n        throw error;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 196,
      "snippet": "        invalidateProfileCache(uid);\n    } catch (error) {\n        console.error('[UserService] Save pin color failed:', error);\n        throw error;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 214,
      "snippet": "        invalidateProfileCache(uid);\n    } catch (error) {\n        console.error('[UserService] Save bio failed:', error);\n        throw error;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 231,
      "snippet": "        console.log('[UserService] Push token saved for:', uid);\n    } catch (error) {\n        console.error('[UserService] Save push token failed:', error);\n        // Don't throw, just log. Not critical.\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 260,
      "snippet": "        }\n    } catch (error) {\n        console.error('[UserService] Update pin visibility failed:', error);\n        throw error;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 273,
      "snippet": "        return profile?.hidePinsFrom || [];\n    } catch (error) {\n        console.error('[UserService] Get hidePinsFrom failed:', error);\n        return [];\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 380,
      "snippet": "        console.log(`[UserService] Friend ${friendUid} pins ${hide ? 'hidden' : 'shown'} for user ${uid}`);\n    } catch (error) {\n        console.error('[UserService] Toggle hidden friend failed:', error);\n        throw error;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 399,
      "snippet": "        console.log(`[UserService] Pin ${pinId} ${hide ? 'hidden' : 'shown'} for user ${uid}`);\n    } catch (error) {\n        console.error('[UserService] Toggle hidden pin failed:', error);\n        throw error;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 438,
      "snippet": "        invalidateProfileCache(uid);\n    } catch (error) {\n        console.error('[UserService] Update privacy settings failed:', error);\n        throw error;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 533,
      "snippet": "        });\n    } catch (error) {\n        console.error('[UserService] Update notification settings failed:', error);\n        throw error;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Catch block shows raw error message to user - may expose sensitive backend details",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 622,
      "snippet": "\n        return null;\n    } catch (error: any) {\n        const { Alert } = require('react-native');\n        // Alert.alert('Debug: Fetch Error', `Error: ${error.message}`);",
      "suggestion": "Replace with user-friendly generic messages. Example: \"An error occurred. Please try again.\" Log details securely."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 625,
      "snippet": "        const { Alert } = require('react-native');\n        // Alert.alert('Debug: Fetch Error', `Error: ${error.message}`);\n        console.error('[UserService] Get profile failed:', error);\n        return null;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 675,
      "snippet": "        return { uid: doc.id, ...(doc.data() as UserProfile) };\n    } catch (error) {\n        console.error('[UserService] Get user by username failed:', error);\n        return null;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 707,
      "snippet": "                }\n            } catch (error) {\n                console.warn('[UserService] âŒ REST Fallback failed:', error);\n                onUpdate(null);\n            }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 779,
      "snippet": "                            }\n\n                            console.error('[UserService] âŒ Profile subscription error:', error);\n                            console.error('[UserService] Error code:', error.code);\n                            console.error('[UserService] Error message:', error.message);",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Backend error message or stack trace exposed to user",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 781,
      "snippet": "                            console.error('[UserService] âŒ Profile subscription error:', error);\n                            console.error('[UserService] Error code:', error.code);\n                            console.error('[UserService] Error message:', error.message);\n\n                            // If it's a permission error, call onUpdate(null) to unblock UI",
      "suggestion": "Use generic error messages for users. Log detailed errors server-side only. Never expose stack traces or backend errors."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 799,
      "snippet": "                        timeoutId = null;\n                    }\n                    console.error('[UserService] âŒ Failed to create subscription:', error);\n                    onUpdate(null);\n                }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 831,
      "snippet": "        })\n        .catch((error) => {\n            console.error('[UserService] âŒ Failed to wait for Firestore:', error);\n            console.error('[UserService] Error details:', error);\n            // Still call onUpdate(null) to unblock the UI",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 832,
      "snippet": "        .catch((error) => {\n            console.error('[UserService] âŒ Failed to wait for Firestore:', error);\n            console.error('[UserService] Error details:', error);\n            // Still call onUpdate(null) to unblock the UI\n            onUpdate(null);",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 874,
      "snippet": "        return users;\n    } catch (error) {\n        console.error('[UserService] Search users failed:', error);\n        return [];\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 902,
      "snippet": "        return null;\n    } catch (error) {\n        console.error('[UserService] Get username failed:', error);\n        return null;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 981,
      "snippet": "        return { success: true, message: 'Friend request sent!' };\n    } catch (error: any) {\n        console.error('[UserService] Send request failed:', error);\n        return { success: false, message: error.message || 'Failed to send request.' };\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 1006,
      "snippet": "        return requests.sort((a, b) => b.createdAt?.seconds - a.createdAt?.seconds);\n    } catch (error) {\n        console.error('[UserService] Get requests failed:', error);\n        return [];\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 1030,
      "snippet": "            },\n            (error) => {\n                console.error('[UserService] Friend request subscription error:', error);\n            }\n        );",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 1054,
      "snippet": "\n    } catch (error) {\n        console.error('[UserService] Accept request failed:', error);\n        throw error;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 1104,
      "snippet": "        return Array.from(friendIds);\n    } catch (error) {\n        console.error('[UserService] Get friends failed:', error);\n        return [];\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 1116,
      "snippet": "        await firestore().collection(FRIEND_REQUESTS_COLLECTION).doc(requestId).delete();\n    } catch (error) {\n        console.error('[UserService] Reject request failed:', error);\n        throw error;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 1196,
      "snippet": "        return true;\n    } catch (error) {\n        console.error('[UserService] Delete user data failed:', error);\n        throw error;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 1251,
      "snippet": "        console.log('[UserService] Added to bucket list:', item.locationName);\n    } catch (error) {\n        console.error('[UserService] Add to bucket list failed:', error);\n        throw error;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 1273,
      "snippet": "        console.log('[UserService] Removed from bucket list:', item.locationName);\n    } catch (error) {\n        console.error('[UserService] Remove from bucket list failed:', error);\n        throw error;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 1372,
      "snippet": "\n    } catch (error) {\n        console.error('[UserService] Check streak failed:', error);\n        return { streak: 0, increased: false };\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/userService.ts",
      "line": 1405,
      "snippet": "        console.log(`[UserService] Updated bucketlist status for ${locationName} to ${newStatus}`);\n    } catch (error) {\n        console.error('[UserService] Update bucketlist status failed:', error);\n        throw error;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/wikiService.ts",
      "line": 43,
      "snippet": "const searchWikiTitle = async (query: string): Promise<string | null> => {\n    try {\n        const response = await fetch(\n            `${WIKI_SEARCH_API}?action=opensearch&search=${encodeURIComponent(query)}&limit=1&format=json`,\n            { headers: WIKI_HEADERS }",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/wikiService.ts",
      "line": 89,
      "snippet": "        const url = `${WIKI_SEARCH_API}?action=query&generator=prefixsearch&gpssearch=${encodeURIComponent(query)}&gpslimit=20&prop=coordinates|pageimages|description|extracts&piprop=thumbnail&pithumbsize=200&exintro&explaintext&exsentences=1&format=json`;\n\n        const response = await fetch(url, { headers: WIKI_HEADERS });\n\n        if (!response.ok) {",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/wikiService.ts",
      "line": 177,
      "snippet": "const fetchSummary = async (title: string, apiBase: string, sourceName: 'wikipedia' | 'wikivoyage'): Promise<WikiPlaceDetails | null> => {\n    try {\n        const response = await fetch(`${apiBase}/summary/${encodeURIComponent(title)}`, { headers: WIKI_HEADERS });\n        if (!response.ok) return null;\n",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "NO_REQUEST_TIMEOUT",
      "description": "fetch() without timeout configuration",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/wikiService.ts",
      "line": 229,
      "snippet": "        const url = `${searchApiBase}?action=query&titles=${encodeURIComponent(title)}&prop=pageimages&piprop=thumbnail|original&pithumbsize=600&pilimit=5&format=json`;\n\n        const response = await fetch(url, { headers: WIKI_HEADERS });\n        if (!response.ok) return null;\n",
      "suggestion": "Add timeout using AbortSignal: const controller = new AbortController(); setTimeout(() => controller.abort(), 30000);"
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/wikiService.ts",
      "line": 61,
      "snippet": "        return null;\n    } catch (error) {\n        console.error('Wiki Service Error:', error);\n        return null;\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/wikiService.ts",
      "line": 170,
      "snippet": "\n    } catch (error) {\n        console.error('[WikiService] Search failed:', error);\n        return [];\n    }",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "INSECURE_DESERIALIZATION",
      "description": "JSON.parse() on potentially untrusted data without validation",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/services/wikiService.ts",
      "line": 52,
      "snippet": "        const text = await response.text();\n        try {\n            const data = JSON.parse(text);\n            if (data && data[1] && data[1].length > 0) {\n                return data[1][0];",
      "suggestion": "Validate JSON structure and data types before parsing untrusted input. Use schema validation libraries like Zod or Yup."
    },
    {
      "ruleId": "SENSITIVE_DATA_IN_ERROR_MESSAGES",
      "description": "Error object logged directly - may contain sensitive data or stack traces",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/src/utils/logger.ts",
      "line": 34,
      "snippet": "    safeError: (prefix: string, error: unknown) => {\n        if (isDev) {\n            console.error(prefix, error);\n        } else {\n            // In production, only log simple message",
      "suggestion": "Log only safe error properties (message, code). Sanitize error messages before displaying to users. Never expose stack traces in production."
    },
    {
      "ruleId": "EXPO_INSECURE_PERMISSIONS",
      "description": "Dangerous permission detected: android.permission.ACCESS_FINE_LOCATION",
      "severity": "LOW",
      "filePath": "/Users/lee/Projects/primal-singularity/app.json",
      "suggestion": "Only request necessary permissions and explain usage to users"
    },
    {
      "ruleId": "EXPO_INSECURE_PERMISSIONS",
      "description": "Dangerous permission detected: android.permission.CAMERA",
      "severity": "LOW",
      "filePath": "/Users/lee/Projects/primal-singularity/app.json",
      "suggestion": "Only request necessary permissions and explain usage to users"
    },
    {
      "ruleId": "EXPO_INSECURE_PERMISSIONS",
      "description": "Dangerous permission detected: android.permission.RECORD_AUDIO",
      "severity": "LOW",
      "filePath": "/Users/lee/Projects/primal-singularity/app.json",
      "suggestion": "Only request necessary permissions and explain usage to users"
    },
    {
      "ruleId": "ANDROID_EXPORTED_COMPONENT",
      "description": "Exported activity without permission protection - accessible by any app",
      "severity": "HIGH",
      "filePath": "/Users/lee/Projects/primal-singularity/android/app/src/main/AndroidManifest.xml",
      "suggestion": "Add android:permission attribute to exported activity or set android:exported=\"false\" if external access is not needed."
    },
    {
      "ruleId": "ANDROID_INTENT_FILTER_PERMISSIVE",
      "description": "Permissive intent filter with android.intent.action.VIEW: Can be invoked by any app",
      "severity": "MEDIUM",
      "filePath": "/Users/lee/Projects/primal-singularity/android/app/src/main/AndroidManifest.xml",
      "suggestion": "Validate all incoming intents and restrict with custom permissions if external access is not required."
    },
    {
      "ruleId": "EXCESSIVE_PERMISSIONS",
      "description": "Potentially excessive permissions declared: android.permission.ACCESS_COARSE_LOCATION, android.permission.ACCESS_FINE_LOCATION, android.permission.CAMERA...",
      "severity": "LOW",
      "filePath": "/Users/lee/Projects/primal-singularity/android/app/src/main/AndroidManifest.xml",
      "suggestion": "Review declared permissions and remove those not actively used. Request permissions at runtime only when needed."
    },
    {
      "ruleId": "IOS_BACKGROUND_MODES_UNNECESSARY",
      "description": "Background mode 'remote-notification' enabled: Remote notifications can trigger background activity",
      "severity": "LOW",
      "filePath": "/Users/lee/Projects/primal-singularity/ios/Pinr/Info.plist",
      "suggestion": "Ensure 'remote-notification' background mode is necessary. Remove if not required to reduce attack surface and improve privacy."
    },
    {
      "ruleId": "IOS_DATA_PROTECTION_MISSING",
      "description": "Sensitive app without data protection entitlement",
      "severity": "LOW",
      "filePath": "/Users/lee/Projects/primal-singularity/ios/Pinr/Info.plist",
      "suggestion": "Enable data protection (NSFileProtectionComplete) to encrypt files when device is locked."
    }
  ],
  "scannedFiles": 269,
  "duration": 3346,
  "timestamp": "2026-01-07T23:08:30.097Z"
}